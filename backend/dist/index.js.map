{"version":3,"file":"index.js","sources":["../src/app/ethers.ts","../src/app/mongo.ts","../src/app/server.ts","../src/helpers/gameHelpers/effect/lastStand.ts","../src/helpers/gameHelpers/effect/selfDestruct.ts","../src/helpers/gameHelpers/effect/revenge.ts","../src/helpers/gameHelpers/insertBuff.ts","../src/helpers/gameHelpers/effect/unity.ts","../src/helpers/gameHelpers/moveToGraveyard.ts","../src/helpers/gameHelpers/effect/heartOfSteel.ts","../src/helpers/gameHelpers/deductHealth.ts","../src/helpers/gameHelpers/effect/acidicDeath.ts","../src/helpers/gameHelpers/effect/banish.ts","../src/helpers/gameHelpers/effect/shadowSurge.ts","../src/helpers/gameHelpers/effect/diminish.ts","../src/helpers/gameHelpers/effect/frostbite.ts","../src/helpers/gameHelpers/effect/glory.ts","../src/helpers/gameHelpers/effect/mirrorsEdge.ts","../src/helpers/gameHelpers/effect/risingFury.ts","../src/helpers/gameHelpers/effect/blaze.ts","../src/helpers/gameHelpers/insertDebuff.ts","../src/helpers/gameHelpers/effect/necromancy.ts","../src/helpers/gameHelpers/effect/quickShot.ts","../src/helpers/gameHelpers/effect/rebirth.ts","../src/helpers/gameHelpers/effect/reload.ts","../src/helpers/gameHelpers/effect/ricochet.ts","../src/helpers/gameHelpers/effect/shell.ts","../src/helpers/gameHelpers/getAdjacentMinions.ts","../src/helpers/gameHelpers/effect/shieldwall.ts","../src/helpers/gameHelpers/effect/silence.ts","../src/helpers/gameHelpers/effect/smite.ts","../src/helpers/gameHelpers/effect/spellweave.ts","../src/helpers/gameHelpers/effect/toxicSpray.ts","../src/helpers/gameHelpers/effect/valor.ts","../src/helpers/gameHelpers/effect/fortitude.ts","../src/helpers/gameHelpers/effect/regeneration.ts","../src/helpers/gameHelpers/effect/leech.ts","../src/helpers/gameHelpers/effect/electroShock.ts","../src/helpers/gameHelpers/effect/cleanse.ts","../src/helpers/gameHelpers/effect/tidalWave.ts","../src/helpers/gameHelpers/effect/retribution.ts","../src/helpers/gameHelpers/effect/corrosiveTouch.ts","../src/helpers/gameHelpers/effect/toxicGas.ts","../src/helpers/gameHelpers/effect/acidRain.ts","../src/helpers/gameHelpers/effect/smokeBomb.ts","../src/helpers/gameHelpers/effect/contaminatedAir.ts","../src/helpers/gameHelpers/effect/noxiousFumes.ts","../src/helpers/gameHelpers/effect/poisonedGround.ts","../src/helpers/gameHelpers/effect/rampage.ts","../src/helpers/gameHelpers/effect/backstab.ts","../src/helpers/gameHelpers/effect/overpower.ts","../src/helpers/gameHelpers/effect/ignite.ts","../src/helpers/gameHelpers/effect/corruption.ts","../src/helpers/gameHelpers/effect/hysteria.ts","../src/helpers/gameHelpers/effect/explosive.ts","../src/helpers/gameHelpers/effect/reflection.ts","../src/helpers/gameHelpers/effect/constriction.ts","../src/helpers/gameHelpers/effect/index.ts","../src/helpers/gameHelpers/generateGameView.ts","../src/helpers/gameHelpers/attackMinionSave.ts","../src/helpers/gameHelpers/buildDeck.ts","../src/helpers/gameHelpers/endGame.ts","../src/helpers/gameHelpers/drawCard.ts","../src/helpers/gameHelpers/gamePopup.ts","../src/helpers/gameHelpers/generateGame.ts","../src/helpers/gameHelpers/getGame.ts","../src/helpers/gameHelpers/getRandomMinion.ts","../src/helpers/gameHelpers/isGameOver.ts","../src/helpers/gameHelpers/saveGame.ts","../src/helpers/gameHelpers/startGame.ts","../src/helpers/gameHelpers/index.ts","../src/helpers/playerHelpers/getSocketIds.ts","../src/helpers/playerHelpers/isDeckValid.ts","../src/helpers/playerHelpers/index.ts","../src/requests/auth/disconnect.ts","../src/requests/auth/signin.ts","../src/requests/auth/signup.ts","../src/requests/auth/index.ts","../src/requests/client/acceptGame.ts","../src/requests/client/closeLobby.ts","../src/requests/client/createLobby.ts","../src/requests/client/declineGame.ts","../src/requests/client/defaultSkin.ts","../src/requests/client/finishTutorial.ts","../src/requests/client/getLeaderboards.ts","../src/requests/client/joinLobby.ts","../src/requests/client/joinQueue.ts","../src/requests/client/leaveLobby.ts","../src/requests/client/leaveQueue.ts","../src/requests/client/saveDeck.ts","../src/requests/client/selectDeck.ts","../src/requests/client/selectSkin.ts","../src/requests/client/startCustomGame.ts","../src/requests/client/index.ts","../src/requests/game/attackHero.ts","../src/requests/game/attackMinion.ts","../src/requests/game/endTurn.ts","../src/requests/game/playMagic.ts","../src/requests/game/playMinion.ts","../src/requests/game/playTrap.ts","../src/requests/game/index.ts","../src/requests/sidenav/acceptFriend.ts","../src/requests/sidenav/addFriend.ts","../src/requests/sidenav/blockFriend.ts","../src/requests/sidenav/declineFriend.ts","../src/requests/sidenav/removeFriend.ts","../src/requests/sidenav/sendChatMessage.ts","../src/requests/sidenav/setAvatar.ts","../src/requests/sidenav/unblockFriend.ts","../src/requests/sidenav/updateStatus.ts","../src/requests/sidenav/index.ts","../src/requests/index.ts","../src/index.ts"],"sourcesContent":["import {JsonRpcProvider, Wallet, Contract} from \"ethers\";\r\nimport SomGame from \"@som/contracts/SomGame/artifacts/SomGame.json\" assert {type: \"json\"};\r\nimport SomSkins from \"@som/contracts/SomTokens/artifacts/SomTokens.json\" assert {type: \"json\"};\r\n\r\n// const provider = new JsonRpcProvider(\"https://testnet.telos.net\", undefined, {\r\n//   batchMaxCount: 1\r\n// });\r\nconst provider = undefined;\r\nconst signer = new Wallet(\"0x36558f992d19662cdea021407513e14f83f47917ba0a28fd879ff148afd0edd2\", provider);\r\n\r\nconst gameKey = \"0xA1584c8E3e572101D0D28A9ebb1784Af9f0fBCd4\";\r\nconst skinsKey = \"0x759F6751A243cc8EacC959bd10A910831A670720\";\r\n\r\nconst game = new Contract(gameKey, SomGame.abi, signer);\r\nconst skins = new Contract(skinsKey, SomSkins.abi, signer);\r\n\r\nconst contracts = {game, skins};\r\n\r\nexport {contracts};\r\n","import {MongoClient} from \"mongodb\";\n\nimport type {\n  Account,\n  CasualQueuePlayer,\n  Chat,\n  Game,\n  GamePopup,\n  Lobby,\n  MarketItem,\n  Player,\n  RankedQueuePlayer\n} from \"@som/shared/types/mongo\";\n\nconst mongoClient = await MongoClient.connect(\"mongodb://127.0.0.1:27017\");\nconst eternitas = mongoClient.db(\"eternitas\");\nconst som = mongoClient.db(\"som\");\n\nconst mongo = {\n  $accounts: eternitas.collection<Account>(\"accounts\"),\n  $chats: eternitas.collection<Chat>(\"chats\"),\n  $casualQueuePlayers: som.collection<CasualQueuePlayer>(\"casualQueuePlayers\"),\n  $games: som.collection<Game>(\"games\"),\n  $gamePopups: som.collection<GamePopup>(\"gamePopups\"),\n  $lobbies: som.collection<Lobby>(\"lobbies\"),\n  $marketItems: som.collection<MarketItem>(\"marketItems\"),\n  $players: som.collection<Player>(\"players\"),\n  $rankedQueuePlayers: som.collection<RankedQueuePlayer>(\"rankedQueuePlayers\")\n};\n\nexport {mongo};\n","import {createServer} from \"http\";\r\nimport {Server} from \"socket.io\";\r\nimport type {Responses} from \"@som/shared/types/responses\";\r\nimport type {Requests} from \"@som/shared/types/requests\";\r\n\r\nconst http = createServer();\r\n\r\nconst io = new Server<Requests, Responses>(http, {\r\n  cors: {\r\n    origin: \"*\"\r\n  },\r\n  serveClient: false,\r\n  transports: [\"websocket\"],\r\n  allowUpgrades: false\r\n});\r\n\r\nconst server = {http, io};\r\n\r\nexport {server};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface LastStand {\r\n  minion: GameMinionCard;\r\n  opponent: GamePlayer;\r\n  trap: GameTrapCard;\r\n}\r\n\r\nconst lastStand = (params: LastStand) => {\r\n  const {minion, opponent, trap} = params;\r\n\r\n  minion.health = 1;\r\n  minion.buffs.push({id: EffectId.TAUNT, data: {}});\r\n  opponent.graveyard.push(trap);\r\n  opponent.trap = undefined;\r\n\r\n  return [true, \"Last stand triggered\"];\r\n};\r\n\r\nexport {lastStand};\r\n","import type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface SelfDesctruct {\r\n  player: GamePlayer;\r\n}\r\n\r\nconst selfDestruct = (params: SelfDesctruct) => {\r\n  params.player.field.hero.health -= 3;\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {selfDestruct};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GamePlayer, MinionField} from \"@som/shared/types/mongo\";\r\n\r\ninterface Revenge {\r\n  player: GamePlayer;\r\n  field: MinionField;\r\n}\r\n\r\nconst revenge = (params: Revenge) => {\r\n  const {player, field} = params;\r\n\r\n  const handCard = player.hand.find((card) => card.effect === EffectId.REVENGE) as GameMinionCard | undefined;\r\n  const deckCard = player.deck.find((card) => card.effect === EffectId.REVENGE) as GameMinionCard | undefined;\r\n\r\n  if (!handCard && !deckCard) {\r\n    return [false, \"No copy of the card found.\"];\r\n  }\r\n\r\n  if (handCard) {\r\n    const index = player.hand.indexOf(handCard);\r\n    player.field[field] = handCard;\r\n    player.hand.splice(index, 1);\r\n  } else if (deckCard) {\r\n    const index = player.deck.indexOf(deckCard);\r\n    player.field[field] = deckCard;\r\n    player.deck.splice(index, 1);\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {revenge};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GameHeroCard} from \"@som/shared/types/mongo\";\r\n\r\nconst insertBuff = (card: GameMinionCard | GameHeroCard, id: EffectId, data: any = {}) => {\r\n  // switch (id) {\r\n  //   case EffectId.BLAZE:\r\n  //     const hasAttackedTwice = true;\r\n  //     card.buffs.push({id, data: {hasAttackedTwice}});\r\n  //     break;\r\n  //   case EffectId.NECROMANCY:\r\n  //     card.health -= 2;\r\n  // }\r\n\r\n  card.buffs.push({id, data});\r\n\r\n\r\n  // card.buffs.push({id, data});\r\n  return [true, ``];\r\n};\r\n\r\nexport {insertBuff};\r\n","import {EffectId} from \"@som/shared/enums\";\nimport {insertBuff} from \"../insertBuff\";\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\n\ninterface Unity {\n  player: GamePlayer;\n}\n\nconst unity = (params: Unity) => {\n  const {player} = params;\n\n  const handCard = player.hand.find((card) => card.effect === EffectId.UNITY) as GameMinionCard | undefined;\n  const deckCard = player.deck.find((card) => card.effect === EffectId.UNITY) as GameMinionCard | undefined;\n\n  if (!handCard && !deckCard) {\n    return [false, \"No copy of the card found in hand or deck.\"];\n  }\n\n  if (handCard) {\n    insertBuff(handCard, EffectId.TAUNT);\n  } else if (deckCard) {\n    insertBuff(deckCard, EffectId.TAUNT);\n  }\n\n  return [true, \"\"];\n};\n\nexport {unity};\n","import {cards} from \"@som/shared/data\";\r\nimport {EffectId} from \"@som/shared/enums\";\r\nimport {revenge} from \"./effect/revenge\";\r\nimport {unity} from \"./effect/unity\";\r\nimport type {Field, GameMinionCard, GamePlayer, MinionField} from \"@som/shared/types/mongo\";\r\n\r\nconst moveToGraveyard = (player: GamePlayer, minion: GameMinionCard, field: MinionField): void => {\r\n  const hasRevengeBuff = minion.buffs.find((buff) => buff.id === EffectId.REVENGE) !== undefined;\r\n  const hasUnityBuff = minion.buffs.find((buff) => buff.id === EffectId.UNITY) !== undefined;\r\n\r\n  const card: any = cards.find((card) => card.id === minion.id);\r\n\r\n  if (!card) return;\r\n\r\n  minion.health = minion.maxHealth;\r\n  minion.damage = card.damage;\r\n  minion.buffs = [];\r\n  minion.debuffs = [];\r\n  player.graveyard.push(minion);\r\n  player.field[field] = undefined;\r\n\r\n  if (hasRevengeBuff) {\r\n    revenge({player, field});\r\n  }\r\n\r\n  if (hasUnityBuff) {\r\n    unity({player});\r\n  }\r\n};\r\n\r\nexport {moveToGraveyard};\r\n","import type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface HeartOfSteel {\r\n  minion: GameMinionCard;\r\n  player: GamePlayer;\r\n  trap: GameTrapCard;\r\n}\r\n\r\nconst heartOfSteel = (params: HeartOfSteel) => {\r\n  params.minion.damage += 3;\r\n  params.player.graveyard.push(params.trap);\r\n  params.player.trap = undefined;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {heartOfSteel};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport {heartOfSteel} from \"./effect/heartOfSteel\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\n\r\nconst deductHealth = (\r\n  player: GamePlayer,\r\n  minion: GameMinionCard,\r\n  damage: number\r\n): Animations => {\r\n  const shieldBuff = minion.buffs.find(\r\n    (buff): boolean => buff.id === EffectId.SHIELD\r\n  );\r\n\r\n  const animations: Animations = [];\r\n\r\n  if (shieldBuff) { // has shield\r\n    const amt = shieldBuff.data.amount;\r\n\r\n    if (amt > damage) { // shield reduced\r\n      shieldBuff.data.amount -= damage\r\n      animations.push({\r\n        type: \"FLOATING_TEXT\",\r\n        field: \"a\",\r\n        name: player.name,\r\n        text: `-${damage} Shield`\r\n      });\r\n    } else if (amt <= damage) { // shield broken\r\n      if (player.trap && player.trap.effect === EffectId.HEART_OF_STEEL) {\r\n        heartOfSteel({minion, player, trap: player.trap});\r\n      }\r\n\r\n      const remaining = shieldBuff.data.amount - damage;\r\n\r\n      if (remaining < 0) {\r\n        if (minion.buffs.find((buff) => buff.id === EffectId.RESILIENT)) {\r\n          minion.health -= 1;\r\n        } else {\r\n          minion.health -= remaining;\r\n        }\r\n      }\r\n\r\n      const index = minion.buffs.indexOf(shieldBuff);\r\n      minion.buffs.splice(index, 1);\r\n    }\r\n  } else { // no shield\r\n    if (minion.buffs.find((buff) => buff.id === EffectId.RESILIENT)) {\r\n      minion.health -= 1;\r\n    } else {\r\n      minion.health -= damage;\r\n    }\r\n  }\r\n\r\n  return animations;\r\n};\r\n\r\nexport {deductHealth};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {lastStand} from \"./lastStand\";\r\nimport {selfDestruct} from \"./selfDestruct\";\r\nimport {moveToGraveyard} from \"../moveToGraveyard\";\r\nimport {deductHealth} from \"../deductHealth\";\r\nimport {isGameOver} from \"../isGameOver\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\nimport type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface AcidicDeath {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst acidicDeath = (params: AcidicDeath): Animations => {\r\n  const {player, opponent} = params;\r\n  const playerMinionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n  const opponentMinionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n\r\n  playerMinionKeys.forEach((key) => {\r\n    const minion = player.field[key];\r\n\r\n    if (!minion || minion.type === CardType.HERO) { return; }\r\n\r\n    deductHealth(player, minion, 1);\r\n\r\n    if (minion.health <= 0) {\r\n      const {trap} = player;\r\n\r\n      if (trap && trap.effect === EffectId.LAST_STAND) {\r\n        lastStand({minion, opponent: player, trap})\r\n      } else {\r\n        const hasAcidicDeathBuff = minion.buffs.find((buff) => buff.id === EffectId.ACIDIC_DEATH);\r\n\r\n        moveToGraveyard(player, minion, key);\r\n\r\n        if (hasAcidicDeathBuff) {\r\n          acidicDeath({player, opponent});\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  opponentMinionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (!minion || minion.type === CardType.HERO) { return; }\r\n\r\n    deductHealth(opponent, minion, 1);\r\n\r\n    if (minion.health <= 0) {\r\n      const {trap} = opponent;\r\n\r\n      if (trap && trap.effect === EffectId.LAST_STAND) {\r\n        lastStand({minion, opponent, trap})\r\n      } else {\r\n        const hasAcidicDeathBuff = minion.buffs.find((buff) => buff.id === EffectId.ACIDIC_DEATH);\r\n        const hasSelfDescturctDebuff = minion.debuffs.find((debuff) => debuff.id === EffectId.SELF_DESTRUCT);\r\n\r\n        moveToGraveyard(opponent, minion, key);\r\n\r\n        if (hasSelfDescturctDebuff) {\r\n          selfDestruct({player}); // check for endgame? find a better way to call onDeath effects?\r\n        }\r\n\r\n        if (hasAcidicDeathBuff) {\r\n          acidicDeath({player, opponent});\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  return [true, \"Acidic Death triggered.\"] as any;\r\n};\r\n\r\nexport {acidicDeath};\r\n","import type {GameMinionCard, GamePlayer, GameTrapCard, MinionField} from \"@som/shared/types/mongo\";\r\n\r\ninterface Banish {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n  minion: GameMinionCard;\r\n  trap: GameTrapCard;\r\n  field: MinionField;\r\n}\r\n\r\nconst banish = (params: Banish) => {\r\n  const {player, opponent, minion, trap, field} = params;\r\n\r\n  player.field[field] = undefined;\r\n  player.hand.push(minion);\r\n  opponent.graveyard.push(trap);\r\n  opponent.trap = undefined;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {banish};\r\n","import type {GameMinionCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface ShadowSurge {\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst shadowSurge = (params: ShadowSurge) => {\r\n  params.minion.canAttack = true;\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {shadowSurge};\r\n","import {EffectId} from \"@som/shared/enums\";\nimport type {Field, GamePlayer, MinionField} from \"@som/shared/types/mongo\";\n\ninterface Diminish {\n  opponent: GamePlayer;\n  field?: MinionField;\n}\n\nconst diminish = (params: Diminish) => {\n  const {opponent, field} = params;\n\n  if (!field) {\n    return [false, \"Field for Effect not specified.\"];\n  }\n\n  const card = opponent.field[field];\n\n  if (!card) {\n    return [false, `Minion doesn't exist on the field ${field}.`];\n  }\n\n\n\n  if (card.buffs.find((buff) => buff.id === EffectId.ELUSIVE) !== undefined) {\n    return [false, \"Diminish negated.\"];\n  }\n\n  if (card.damage > 2) {\n    card.damage -= 2;\n  } else {\n    card.damage = 0;\n  }\n\n  card.debuffs.push({\n    id: EffectId.DIMINISH,\n    data: {damage: -2}\n  });\n\n  return [true, `\n    Player ${opponent.name} has played Diminish magic card, reducing your card on\n    the field ${field} Damage by 2.\n  `];\n};\n\nexport {diminish};\n","import type {Field, GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\n\r\ninterface Frostbite {\r\n  player: GamePlayer;\r\n  playerMinion: GameMinionCard;\r\n  playerMinionField: Field;\r\n  opponent: GamePlayer;\r\n  opponentTrap: GameTrapCard;\r\n}\r\n\r\nconst frostbite = (params: Frostbite): Animations => {\r\n  const {player, playerMinion, playerMinionField, opponent, opponentTrap} = params;\r\n\r\n  playerMinion.damage = 1;\r\n  opponent.graveyard.push(opponentTrap);\r\n  opponent.trap = undefined;\r\n\r\n  return [{\r\n    type: \"FLOATING_TEXT\",\r\n    field: playerMinionField,\r\n    name: player.name,\r\n    text: \"+Frostbite\",\r\n  }];\r\n};\r\n\r\nexport {frostbite};\r\n","import {randomInt} from \"crypto\";\r\nimport {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\nimport { moveToGraveyard } from \"../moveToGraveyard\";\r\nimport { deductHealth } from \"../deductHealth\";\r\nimport { insertBuff } from \"../insertBuff\";\r\n\r\ninterface Glory {\r\n  opponent: GamePlayer;\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst glory = (params: Glory) => {\r\n  const {opponent, minion} = params;\r\n  const possibleMinions: Array<{Minion: GameMinionCard, key: keyof typeof opponent.minion}> = [];\r\n  const minionKeys = Object.keys(opponent.minion) as Array<keyof typeof opponent.minion>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const Minion = opponent.minion[key];\r\n\r\n    if (Minion) {\r\n      const hasElusiveBuff = Minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        possibleMinions.push({Minion, key});\r\n      }\r\n    }\r\n  });\r\n\r\n  if (possibleMinions.length) {\r\n    let randomMinion = randomInt(possibleMinions.length);\r\n    let {Minion, key} = possibleMinions[randomMinion];\r\n\r\n    deductHealth(opponent, Minion, 2);\r\n\r\n    if (minion.health <= 0) {\r\n      moveToGraveyard(opponent, Minion, key);\r\n      insertBuff(minion, EffectId.TAUNT); // refactor this, minion = player, Minion = opponent\r\n    }\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {glory};\r\n","import type {\r\n  GameMinionCard,\r\n  GamePlayer,\r\n  GameTrapCard\r\n} from \"@som/shared/types/mongo\";\r\n\r\nimport type {Animations} from \"@som/shared/types/game\";\r\n\r\ninterface MirrorsEdge {\r\n  player: GamePlayer;\r\n  playerMinion: GameMinionCard;\r\n  opponent: GamePlayer;\r\n  opponentTrap: GameTrapCard;\r\n}\r\n\r\nconst mirrorsEdge = (params: MirrorsEdge): Animations => {\r\n  const {player, playerMinion, opponent, opponentTrap} = params;\r\n\r\n  player.field.hero.health -= playerMinion.damage;\r\n  opponent.graveyard.push(opponentTrap);\r\n  opponent.trap = undefined;\r\n\r\n  return [{\r\n    type: \"TRAP\",\r\n    id: opponentTrap.id\r\n  }, {\r\n    type: \"DAMAGE\",\r\n    field: (\"hero\" as any),\r\n    damageTaken: playerMinion.damage,\r\n    name: player.name\r\n  }];\r\n};\r\n\r\nexport {mirrorsEdge};\r\n","import type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface RisingFury {\r\n  minionCard: GameMinionCard;\r\n}\r\n\r\nconst risingFury = (params: RisingFury) => {\r\n  const {minionCard} = params;\r\n\r\n  minionCard.health += 1;\r\n  minionCard.damage += 1;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {risingFury};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface Blaze {\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst blaze = (params: Blaze) => {\r\n  const blazeBuff = params.minion.buffs.find((buff) => buff.id === EffectId.BLAZE);\r\n\r\n  if (!blazeBuff) {\r\n    return [false, \"Blaze buff not found.\"];\r\n  }\r\n\r\n  blazeBuff.data.hasAttackedTwice = false;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {blaze};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GameHeroCard} from \"@som/shared/types/mongo\";\r\n\r\nconst insertDebuff = (card: GameMinionCard | GameHeroCard, id: EffectId, data: any = {}) => {\r\n  card.debuffs.push({id, data});\r\n  return [true, \"Debuff added.\"];\r\n};\r\n\r\nexport {insertDebuff};\r\n","import type {GameMinionCard} from \"@som/shared/types/mongo\";\r\nimport { insertBuff } from \"../insertBuff\";\r\nimport { insertDebuff } from \"../insertDebuff\";\r\nimport { EffectId } from \"@som/shared/enums\";\r\n\r\ninterface Necromancy {\r\n  minion: GameMinionCard;\r\n  isPositive: boolean;\r\n}\r\n\r\nconst necromancy = (params: Necromancy) => {\r\n  const {minion, isPositive} = params;\r\n\r\n  if (isPositive) {\r\n    minion.health += 2;\r\n    minion.damage += 2;\r\n\r\n    insertBuff(minion, EffectId.NECROMANCY, {\r\n      health: 2,\r\n      damage: 2\r\n    });\r\n  } else {\r\n    minion.health -= 2;\r\n    minion.damage -= 2;\r\n\r\n    insertDebuff(minion, EffectId.NECROMANCY, {\r\n      health: -2,\r\n      damage: -2\r\n    });\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {necromancy};\r\n","import {randomInt} from \"crypto\";\r\nimport {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {moveToGraveyard} from \"../moveToGraveyard\";\r\nimport { deductHealth } from \"../deductHealth\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface QuickShot {\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst quickShot = (params: QuickShot) => {\r\n  const {opponent} = params;\r\n  const possibleMinions: Array<{minion: GameMinionCard, key: keyof typeof opponent.field}> = [];\r\n  const minionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        possibleMinions.push({minion, key});\r\n      }\r\n    }\r\n  });\r\n\r\n  if (possibleMinions.length) {\r\n    let randomMinion = randomInt(possibleMinions.length);\r\n    let {minion, key} = possibleMinions[randomMinion];\r\n\r\n    deductHealth(opponent, minion, 2);\r\n\r\n    if (minion.health <= 0) {\r\n      moveToGraveyard(opponent, minion, key);\r\n    }\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {quickShot};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\nimport type {GamePlayer, MinionField} from \"@som/shared/types/mongo\";\n\ninterface Rebirth {\n  player: GamePlayer;\n  target?: number;\n  field?: MinionField;\n}\n\nconst rebirth = (params: Rebirth) => {\n  const {player, target, field} = params;\n\n  if (!target) {\n    return [false, \"Target for revival not specified.\"];\n  }\n\n  if (!field) {\n    return [false, \"Field for Special Summon not specified.\"];\n  }\n\n  if (player.field[field]) {\n    return [false, `Minion already exists on the field ${field}.`];\n  }\n\n  const toRevive = player.graveyard.find((card) => card.gid === target);\n\n  if (!toRevive) {\n    return [false, \"Card with the given ID not found in the graveyard.\"];\n  }\n\n  if (toRevive.type !== CardType.MINION) {\n    return [false, \"Selected card for revival must be a Minion.\"];\n  }\n\n  if (toRevive.effect === EffectId.ELUSIVE) {\n    return [false, \"Rebirth negated.\"];\n  }\n\n  if (toRevive.effect === EffectId.NECROMANCY) {\n    toRevive.damage += 2;\n    toRevive.health += 2;\n    toRevive.buffs.push({\n      id: EffectId.NECROMANCY,\n      data: {damage: 2, health: 2}\n    });\n  }\n\n  if (toRevive.effect === EffectId.PROTECTOR) {\n    toRevive.buffs.push({id: EffectId.SHIELD, data: {amount: 3}});\n  }\n\n  player.field[field] = toRevive;\n  player.graveyard.splice(player.graveyard.indexOf(toRevive), 1);\n\n  return [true, \"Successfully revived.\"];\n};\n\nexport {rebirth};\n","import type {GamePlayer} from \"@som/shared/types/mongo\";\n\ninterface Reload {\n  player: GamePlayer;\n}\n\nconst reload = (params: Reload) => {\n  const {player} = params;\n  const drawnCard = player.deck.pop();\n\n  if (!drawnCard) {\n    return [false, \"You have no cards remaining to draw.\"];\n  }\n\n  player.hand.push(drawnCard);\n\n  return [true, \"\"];\n};\n\nexport {reload};\n","import { EffectId } from \"@som/shared/enums\";\r\nimport { randomInt } from \"crypto\";\r\nimport { moveToGraveyard } from \"../moveToGraveyard\";\r\nimport { deductHealth } from \"../deductHealth\";\r\nimport type { Animations } from \"@som/shared/types/game\";\r\nimport type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface Ricochet {\r\n  player: GamePlayer;\r\n  playerMinion: GameMinionCard;\r\n  opponent: GamePlayer;\r\n  opponentTrap: GameTrapCard;\r\n}\r\n\r\nconst ricochet = (params: Ricochet): Animations => {\r\n  const {player, playerMinion, opponent, opponentTrap} = params;\r\n  const animations: Animations = [];\r\n\r\n  const possibleMinions: Array<{minion: GameMinionCard, key: keyof typeof player.field}> = [];\r\n  const minionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = player.field[key];\r\n\r\n    if (minion) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        possibleMinions.push({minion, key});\r\n      }\r\n    }\r\n  });\r\n\r\n  // animations.push({\r\n  //   type: \"TRAP\",\r\n  //   id: opponentTrap.id,\r\n  //   name: opponent.name\r\n  // });\r\n\r\n  if (possibleMinions.length) {\r\n    let randomMinion = randomInt(possibleMinions.length);\r\n    let {minion, key} = possibleMinions[randomMinion];\r\n\r\n    deductHealth(player, minion, playerMinion.damage);\r\n\r\n    animations.push({\r\n      type: \"FLOATING_TEXT\",\r\n      field: key,\r\n      name: player.name,\r\n      text: \"Ricochet\"\r\n    }, {\r\n      type: \"DAMAGE\",\r\n      damageTaken: playerMinion.damage,\r\n      field: key,\r\n      name: player.name\r\n    });\r\n\r\n    if (minion.health <= 0) {\r\n      moveToGraveyard(player, minion, key);\r\n\r\n      animations.push({\r\n        type: \"DEATH\",\r\n        field: key,\r\n        name: player.name\r\n      });\r\n    }\r\n  }\r\n\r\n  opponent.graveyard.push(opponentTrap);\r\n  opponent.trap = undefined;\r\n\r\n  return animations;\r\n};\r\n\r\nexport {ricochet};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport {insertBuff} from \"../insertBuff\";\r\nimport type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Shell {\r\n  player: GamePlayer;\r\n}\r\n\r\nconst shell = (params: Shell): any => {\r\n  const {player} = params;\r\n  const keys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  keys.forEach((field) => {\r\n    const minion = player.field[field];\r\n\r\n    if (minion) {\r\n      const shieldBuff = minion.buffs.find((buff) => buff.id === EffectId.SHIELD);\r\n      const unbreakableBuff = minion.buffs.find((buff) => buff.id === EffectId.UNBREAKABLE);\r\n      const amount = unbreakableBuff ? 2 : 1;\r\n\r\n      if (shieldBuff) {\r\n        shieldBuff.data.amount += amount;\r\n      } else {\r\n        insertBuff(minion, EffectId.SHIELD, {amount});\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nexport {shell};\r\n","const getAdjacentMinions = (field: \"a\" | \"b\" | \"c\" | \"d\") => {\r\n  const adjacentFields = [];\r\n\r\n  switch (field) {\r\n    case \"a\":\r\n      adjacentFields.push(\"b\");\r\n      break;\r\n    case \"b\":\r\n      adjacentFields.push(\"a\", \"c\");\r\n      break;\r\n    case \"c\":\r\n      adjacentFields.push(\"b\", \"d\");\r\n      break;\r\n    case \"d\":\r\n      adjacentFields.push(\"c\");\r\n      break;\r\n  }\r\n\r\n  return adjacentFields;\r\n};\r\n\r\nexport {getAdjacentMinions};\r\n","import {EffectId} from \"@som/shared/enums\";\nimport {getAdjacentMinions} from \"../getAdjacentMinions\";\nimport {insertBuff} from \"../insertBuff\";\nimport type {GamePlayer, MinionField} from \"@som/shared/types/mongo\";\n\ninterface Shieldwall {\n  player: GamePlayer;\n  field: MinionField;\n}\n\nconst shieldwall = (params: Shieldwall): void => {\n  const {player, field} = params;\n  const fields = getAdjacentMinions(field);\n\n  fields.forEach((field) => {\n    const minion = player.field[field as keyof typeof player.field];\n\n    if (minion) {\n      const shieldBuff = minion.buffs.find((buff) => buff.id === EffectId.SHIELD);\n      const unbreakableBuff = minion.buffs.find((buff) => buff.id === EffectId.UNBREAKABLE);\n      const amount = unbreakableBuff ? 2 : 1;\n\n      if (shieldBuff) {\n        shieldBuff.data.amount += amount;\n      } else {\n        insertBuff(minion, EffectId.SHIELD, {amount});\n      }\n    }\n  });\n};\n\nexport {shieldwall};\n","import type {GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\n\ninterface Silence {\n  opponent: GamePlayer;\n  trap: GameTrapCard;\n}\n\nconst silence = (params: Silence) => {\n  const {opponent, trap} = params;\n\n  opponent.graveyard.push(trap);\n  opponent.trap = undefined;\n\n  return [true, \"\"]\n};\n\nexport {silence};\n","import {moveToGraveyard} from \"../moveToGraveyard\";\r\nimport type {GameMinionCard, GamePlayer, GameTrapCard, MinionField} from \"@som/shared/types/mongo\";\r\n\r\ninterface Smite {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n  minion: GameMinionCard;\r\n  trap: GameTrapCard;\r\n  field: MinionField;\r\n}\r\n\r\nconst smite = (params: Smite) => {\r\n  const {player, opponent, minion, trap, field} = params;\r\n\r\n  moveToGraveyard(player, minion, field);\r\n\r\n  opponent.graveyard.push(trap);\r\n  opponent.trap = undefined;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {smite};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {insertBuff} from \"../insertBuff\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Spellweave {\r\n  player: GamePlayer;\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst spellweave = (params: Spellweave) => {\r\n  const {player, minion} = params;\r\n\r\n  const amount = player.graveyard.reduce((sum, card) => {\r\n    if (card.type === CardType.MAGIC) {\r\n      return sum += 1;\r\n    }\r\n\r\n    return sum;\r\n  }, 0);\r\n\r\n  insertBuff(minion, EffectId.SHIELD, {amount});\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {spellweave};\r\n","import {randomInt} from \"crypto\";\r\nimport { CardType, EffectId } from \"@som/shared/enums\";\r\nimport { moveToGraveyard } from \"../moveToGraveyard\";\r\nimport { deductHealth } from \"../deductHealth\";\r\nimport { insertDebuff } from \"../insertDebuff\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface ToxicSpray {\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst toxicSpray = (params: ToxicSpray) => {\r\n  const {opponent} = params;\r\n  const possibleMinions: Array<{minion: GameMinionCard, key: keyof typeof opponent.field}> = [];\r\n  const minionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        possibleMinions.push({minion, key});\r\n      }\r\n    }\r\n  });\r\n\r\n  if (possibleMinions.length) {\r\n    let randomMinion = randomInt(possibleMinions.length);\r\n    let {minion, key} = possibleMinions[randomMinion];\r\n\r\n    deductHealth(opponent, minion, 1);\r\n    insertDebuff(minion, EffectId.NEUROTOXIN);\r\n\r\n    if (minion.health <= 0) {\r\n      moveToGraveyard(opponent, minion, key);\r\n    }\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {toxicSpray};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Valor {\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst valor = (params: Valor) => {\r\n  const {opponent} = params;\r\n\r\n  const minionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n  let totalDamage = 0;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion) {\r\n      const shieldBuff = minion.buffs.find((buff) => buff.id === EffectId.SHIELD);\r\n\r\n      if (shieldBuff) {\r\n        totalDamage += shieldBuff.data.amount;\r\n        minion.buffs.splice(minion.buffs.indexOf(shieldBuff, 1));\r\n      }\r\n    }\r\n  });\r\n\r\n  opponent.field.hero.health -= totalDamage;\r\n\r\n  return [true, \"\"]\r\n};\r\n\r\nexport {valor};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport type {Field, GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\nimport { deductHealth } from \"../deductHealth\";\r\nimport { insertBuff } from \"../insertBuff\";\r\nimport { moveToGraveyard } from \"../moveToGraveyard\";\r\n\r\ninterface Fortitude {\r\n  player: GamePlayer;\r\n  field: Field | undefined;\r\n}\r\n\r\nconst fortitude = (params: Fortitude) => {\r\n  const {player, field} = params;\r\n\r\n  if (!field) {\r\n    return [false, \"Field not specified.\"];\r\n  }\r\n\r\n  const minion = player.field[field];\r\n\r\n  if (!minion || minion.type === CardType.HERO) {\r\n    return [false, `No minion on the ${field} field.`];\r\n  }\r\n\r\n  deductHealth(player, minion, 1);\r\n\r\n  if (minion.health > 0) {\r\n    insertBuff(minion, EffectId.TAUNT);\r\n  } else {\r\n    moveToGraveyard(player, minion, field);\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {fortitude};\r\n","import { randomInt } from \"crypto\";\r\nimport { CardType, EffectId } from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface Regeneration {\r\n  player: GamePlayer;\r\n}\r\n\r\nconst regeneration = (params: Regeneration) => {\r\n  const {player} = params;\r\n  const minionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n  const possibleKeys: Array<\"a\" | \"b\" | \"c\" | \"d\"> = [];\r\n\r\n  minionKeys.forEach((key) => {\r\n    const Minion = player.field[key];\r\n    if (!Minion || Minion.type === CardType.HERO) { return; }\r\n\r\n    if (Minion.buffs.find((buff) => buff.id !== EffectId.REGENERATION)) {\r\n      possibleKeys.push(key);\r\n    }\r\n  });\r\n\r\n  if (possibleKeys.length) {\r\n    const rand = randomInt(possibleKeys.length)\r\n    const min = player.field[possibleKeys[rand]];\r\n    if (!min) { return [false, \"\"]; }\r\n    min.health += 2;\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {regeneration};\r\n","import type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Leech {\r\n  player: GamePlayer;\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst leech = (params: Leech) => {\r\n  const {player, minion} = params;\r\n  player.field.hero.health += minion.damage;\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {leech};\r\n","import type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface ElectroShock {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst electroShock = (params: ElectroShock) => {\r\n  const {player, opponent} = params;\r\n  const playerMinionFields = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n  const opponentMinionFields = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n\r\n  playerMinionFields.forEach((field) => {\r\n    const minion = player.field[field];\r\n\r\n    if (minion) {\r\n      minion.buffs = [];\r\n      minion.debuffs = [];\r\n    }\r\n  });\r\n\r\n  opponentMinionFields.forEach((field) => {\r\n    const minion = opponent.field[field];\r\n\r\n    if (minion) {\r\n      minion.buffs = [];\r\n      minion.debuffs = [];\r\n    }\r\n  });\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {electroShock};\r\n","import type {Field, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Cleanse {\r\n  player: GamePlayer;\r\n  field: Field | undefined;\r\n}\r\n\r\nconst cleanse = (params: Cleanse) => {\r\n  const {player, field} = params;\r\n\r\n  if (!field) {\r\n    return [false, \"Field not specified.\"];\r\n  }\r\n\r\n  const minion = player.field[field];\r\n\r\n  if (!minion) {\r\n    return [false, `No minion on the ${field} field.`];\r\n  }\r\n\r\n  minion.debuffs = [];\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {cleanse};\r\n","import type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface TidalWave {\r\n  player: GamePlayer;\r\n}\r\n\r\nconst tidalWave = (params: TidalWave) => {\r\n  const {player} = params;\r\n  const playerMinionFields = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  playerMinionFields.forEach((field) => {\r\n    const minion = player.field[field];\r\n\r\n    if (minion) {\r\n      minion.health += 3;\r\n    }\r\n  });\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {tidalWave};\r\n","import type {Field, GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\nimport { getAdjacentMinions } from \"../getAdjacentMinions\";\r\n\r\ninterface RisingFury {\r\n  player: GamePlayer;\r\n  field: Field;\r\n}\r\n\r\nconst retribution = (params: RisingFury) => {\r\n  const {player, field} = params;\r\n  const adj = getAdjacentMinions(field);\r\n\r\n  adj.forEach((field) => {\r\n    const minj = player.field[field];\r\n    if (!minj) return;\r\n    minj.damage -= 2;\r\n    if (minj.damage <= 0) {\r\n      minj.damage = 0;\r\n    }\r\n  });\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {retribution};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface CorrosiveTouch {\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst corrosiveTouch = (params: CorrosiveTouch) => {\r\n  const {opponent} = params;\r\n  const minionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n  let damageToHero = 0;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        const hasNeurotoxinDebuff = minion.debuffs.find((debuff) => debuff.id === EffectId.NEUROTOXIN);\r\n\r\n        if (hasNeurotoxinDebuff) {\r\n          damageToHero += 1;\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  opponent.field.hero.health -= damageToHero;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {corrosiveTouch};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport {insertBuff} from \"../insertBuff\";\r\nimport type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface ToxicGas {\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst toxicGas = (params: ToxicGas) => {\r\n  const {opponent} = params;\r\n  const minionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        insertBuff(minion, EffectId.NEUROTOXIN);\r\n      }\r\n    }\r\n  });\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {toxicGas};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {randomInt} from \"crypto\";\r\nimport {insertDebuff} from \"../insertDebuff\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\n\r\ninterface AcidRain {\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst acidRain = (params: AcidRain): Animations => {\r\n  const {opponent} = params;\r\n  const minionKeys = Object.keys(opponent.field) as Array<keyof typeof opponent.field>;\r\n  const possibleMinions: Array<GameMinionCard> = [];\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        possibleMinions.push(minion);\r\n      }\r\n    }\r\n  });\r\n\r\n  const minion1 = possibleMinions[randomInt(possibleMinions.length)];\r\n  const minion2 = possibleMinions[randomInt(possibleMinions.length)];\r\n\r\n  insertDebuff(minion1, EffectId.NEUROTOXIN);\r\n  insertDebuff(minion2, EffectId.NEUROTOXIN);\r\n\r\n  return [];\r\n};\r\n\r\nexport {acidRain};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport {insertBuff} from \"../insertBuff\";\r\nimport type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface SmokeBomb {\r\n  player: GamePlayer;\r\n}\r\n\r\nconst smokeBomb = (params: SmokeBomb) => {\r\n  const {player} = params;\r\n  const minionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = player.field[key];\r\n\r\n    if (minion) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        insertBuff(minion, EffectId.STEALTH);\r\n      }\r\n    }\r\n  });\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {smokeBomb};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {insertDebuff} from \"../insertDebuff\";\r\nimport type {GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface ContaminatedAir {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n}\r\n\r\nconst contaminatedAir = (params: ContaminatedAir) => {\r\n  const {player, opponent} = params;\r\n  const minionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n  const opponentMinionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = player.field[key];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        if (minion.damage > 0) {\r\n          minion.damage -= 1;\r\n        }\r\n\r\n        insertDebuff(minion, EffectId.CONTAMINATED_AIR);\r\n      }\r\n    }\r\n  });\r\n\r\n  opponentMinionKeys.forEach((key) => {\r\n    const minion = opponent.field[key];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        if (minion.damage > 0) {\r\n          minion.damage -= 1;\r\n        }\r\n\r\n        insertDebuff(minion, EffectId.CONTAMINATED_AIR);\r\n      }\r\n    }\r\n  });\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {contaminatedAir};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {Field, GameMinionCard, GamePlayer, GameTrapCard, MinionField} from \"@som/shared/types/mongo\";\r\nimport { deductHealth } from \"../deductHealth\";\r\nimport { moveToGraveyard } from \"../moveToGraveyard\";\r\nimport type { Animations } from \"@som/shared/types/game\";\r\n\r\ninterface NoxiousFumes {\r\n  player: GamePlayer;\r\n  playerMinion: GameMinionCard;\r\n  playerMinionField: MinionField;\r\n  opponent: GamePlayer;\r\n  opponentTrap: GameTrapCard;\r\n}\r\n\r\nconst noxiousFumes = (params: NoxiousFumes): Animations => {\r\n  const {player, opponent, playerMinion, playerMinionField, opponentTrap} = params;\r\n  const animations: Animations = [];\r\n\r\n  const minionKeys = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n  let damage = 0;\r\n\r\n  minionKeys.forEach((key) => {\r\n    const minion = player.field[key];\r\n\r\n    if (minion) {\r\n      const hasElusiveBuff = minion.buffs.find((buff) => buff.id === EffectId.ELUSIVE);\r\n\r\n      if (!hasElusiveBuff) {\r\n        const hasNeurotoxinDebuff = minion.debuffs.find((debuff) => debuff.id === EffectId.NEUROTOXIN);\r\n\r\n        if (hasNeurotoxinDebuff) {\r\n          damage += 1;\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  deductHealth(player, playerMinion, damage);\r\n\r\n  animations.push({\r\n    type: \"FLOATING_TEXT\",\r\n    field: playerMinionField,\r\n    name: player.name,\r\n    text: \"Noxious Fumes\"\r\n  }, {\r\n    type: \"DAMAGE\",\r\n    damageTaken: damage,\r\n    field: playerMinionField,\r\n    name: player.name\r\n  });\r\n\r\n  if (playerMinion.health <= 0) {\r\n    moveToGraveyard(player, playerMinion, playerMinionField);\r\n\r\n    animations.push({\r\n      type: \"DEATH\",\r\n      field: playerMinionField,\r\n      name: player.name\r\n    });\r\n  }\r\n\r\n  opponent.graveyard.push(opponentTrap);\r\n  opponent.trap = undefined;\r\n\r\n  return [];\r\n};\r\n\r\nexport {noxiousFumes};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport {insertDebuff} from \"../insertDebuff\";\r\nimport type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface PoisonedGround {\r\n  player: GamePlayer;\r\n  minion: GameMinionCard;\r\n  trap: GameTrapCard;\r\n}\r\n\r\nconst poisonedGround = (params: PoisonedGround) => {\r\n  const {player, minion, trap} = params;\r\n\r\n  insertDebuff(minion, EffectId.NEUROTOXIN);\r\n  player.graveyard.push(trap);\r\n  player.trap = undefined;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {poisonedGround};\r\n","import type {GameMinionCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface Rampage {\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst rampage = (params: Rampage) => {\r\n  params.minion.damage += 1;\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {rampage};\r\n","import type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Backstab {\r\n  opponent: GamePlayer;\r\n  minion: GameMinionCard;\r\n}\r\n\r\nconst backstab = (params: Backstab) => {\r\n  const {opponent, minion} = params;\r\n\r\n  opponent.field.hero.mana -= 1;\r\n  minion.damage += 2;\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {backstab};\r\n","import type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Overpower {\r\n  opponent: GamePlayer;\r\n  damage: number;\r\n}\r\n\r\nconst overpower = (params: Overpower) => {\r\n  const {opponent, damage} = params;\r\n  opponent.field.hero.health -= damage;\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {overpower};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {moveToGraveyard} from \"../moveToGraveyard\";\r\nimport type {Field, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Ignite {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n  field?: Field;\r\n}\r\n\r\nconst ignite = (params: Ignite) => {\r\n  const {player, opponent, field} = params;\r\n\r\n  if (!field) {\r\n    return [false, \"Field for Effect not specified.\"];\r\n  }\r\n\r\n  const card = opponent.field[field];\r\n\r\n  if (!card || card.type === CardType.HERO) {\r\n    return [false, `Minion doesn't exist on the field ${field}.`];\r\n  }\r\n\r\n  if (card.buffs.find((buff) => buff.id === EffectId.ELUSIVE)) {\r\n    return [false, \"Ignite negated.\"];\r\n  }\r\n\r\n  card.health -= 2;\r\n\r\n  if (card.health <= 0) {\r\n    moveToGraveyard(opponent, card, field);\r\n\r\n    const drawnCard = player.deck.pop();\r\n\r\n    if (drawnCard) {\r\n      player.hand.push(drawnCard);\r\n    }\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {ignite};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {insertBuff} from \"../insertBuff\";\r\nimport {moveToGraveyard} from \"../moveToGraveyard\";\r\nimport type {Field, GamePlayer, MinionField} from \"@som/shared/types/mongo\";\r\n\r\ninterface Corruption {\r\n  player: GamePlayer;\r\n  field?: MinionField;\r\n}\r\n\r\nconst corruption = (params: Corruption) => {\r\n  const {player, field} = params;\r\n\r\n  if (!field) {\r\n    return [false, \"Field for Effect not specified.\"];\r\n  }\r\n\r\n  const card = player.field[field];\r\n\r\n  if (!card) {\r\n    return [false, `Minion doesn't exist on the field ${field}.`];\r\n  }\r\n\r\n  if (card.buffs.find((buff) => buff.id === EffectId.ELUSIVE)) {\r\n    return [false, \"Corruption negated.\"];\r\n  }\r\n\r\n  card.health -= 2;\r\n\r\n  if (card.health <= 0) {\r\n    moveToGraveyard(player, card, field);\r\n  } else {\r\n    insertBuff(card, EffectId.OVERCHARGE);\r\n  }\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {corruption};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {insertBuff} from \"../insertBuff\";\r\nimport type {Field, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Hysteria {\r\n  player: GamePlayer;\r\n  field?: Field;\r\n}\r\n\r\nconst hysteria = (params: Hysteria) => {\r\n  const {player, field} = params;\r\n\r\n  if (!field) {\r\n    return [false, \"Field for Effect not specified.\"];\r\n  }\r\n\r\n  const card = player.field[field];\r\n\r\n  if (!card || card.type === CardType.HERO) {\r\n    return [false, `Minion doesn't exist on the field ${field}.`];\r\n  }\r\n\r\n  if (card.buffs.find((buff) => buff.id === EffectId.ELUSIVE)) {\r\n    return [false, \"Hysteria negated.\"];\r\n  }\r\n\r\n  card.damage *= 2;\r\n  card.health = 1;\r\n\r\n  insertBuff(card, EffectId.HYSTERIA);\r\n\r\n  return [true, \"\"];\r\n};\r\n\r\nexport {hysteria};\r\n","import {getAdjacentMinions} from \"../getAdjacentMinions\";\r\nimport {moveToGraveyard} from \"../moveToGraveyard\";\r\nimport type {Field, GamePlayer, GameTrapCard, MinionField} from \"@som/shared/types/mongo\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\n\r\ninterface Explosive {\r\n  player: GamePlayer;\r\n  playerMinionField: MinionField;\r\n  opponent: GamePlayer;\r\n  opponentTrap: GameTrapCard;\r\n}\r\n\r\nconst explosive = (params: Explosive): Animations => {\r\n  const {player, playerMinionField, opponent, opponentTrap} = params;\r\n  const fields = getAdjacentMinions(playerMinionField) as MinionField[];\r\n\r\n  fields.forEach((field) => {\r\n    const minion = player.field[field];\r\n\r\n    if (minion) {\r\n      minion.health -= 2;\r\n\r\n      if (minion.health <= 0) {\r\n        moveToGraveyard(player, minion, field);\r\n      }\r\n    }\r\n  });\r\n\r\n  opponent.graveyard.push(opponentTrap);\r\n  opponent.trap = undefined;\r\n\r\n  return [];\r\n};\r\n\r\nexport {explosive};\r\n","import { CardType, EffectId } from \"@som/shared/enums\";\r\nimport { getAdjacentMinions } from \"../getAdjacentMinions\";\r\nimport { moveToGraveyard } from \"../moveToGraveyard\";\r\nimport { insertBuff } from \"../insertBuff\";\r\nimport type {Field, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\n\r\ninterface Reflection {\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n  trap: GameTrapCard;\r\n}\r\n\r\nconst reflection = (params: Reflection) => {\r\n  const {player, opponent, trap} = params;\r\n  const fields = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  fields.forEach((field) => {\r\n    const minion = player.field[field];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      insertBuff(minion, EffectId.OVERCHARGE);\r\n    }\r\n  });\r\n\r\n  opponent.graveyard.push(trap);\r\n  opponent.trap = undefined;\r\n\r\n  return [true, \"Last stand triggered\"];\r\n};\r\n\r\nexport {reflection};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport type {GameMinionCard, GamePlayer, GameTrapCard} from \"@som/shared/types/mongo\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\n\r\ninterface Constriction {\r\n  player: GamePlayer;\r\n  playerMinion: GameMinionCard;\r\n  opponent: GamePlayer;\r\n  opponentTrap: GameTrapCard;\r\n}\r\n\r\nconst constriction = (params: Constriction): Animations => {\r\n  const {player, playerMinion, opponent, opponentTrap} = params;\r\n  const fields = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  const sum = fields.reduce((amount, field) => {\r\n    const minion = player.field[field];\r\n    return minion && minion.buffs.find((buff) => buff.id === EffectId.OVERCHARGE) ? amount + 1 : amount;\r\n  }, 0);\r\n\r\n  if (playerMinion.damage >= sum) {\r\n    playerMinion.damage -= sum;\r\n  } else {\r\n    playerMinion.damage = 0;\r\n  }\r\n\r\n  opponent.graveyard.push(opponentTrap);\r\n  opponent.trap = undefined;\r\n\r\n  return [true, \"Last stand triggered\"] as any;\r\n};\r\n\r\nexport {constriction};\r\n","import {acidicDeath} from \"./acidicDeath\";\r\nimport {banish} from \"./banish\";\r\nimport {shadowSurge} from \"./shadowSurge\";\r\nimport {diminish} from \"./diminish\";\r\nimport {frostbite} from \"./frostbite\";\r\nimport {glory} from \"./glory\";\r\nimport {heartOfSteel} from \"./heartOfSteel\";\r\nimport {lastStand} from \"./lastStand\";\r\nimport {mirrorsEdge} from \"./mirrorsEdge\";\r\nimport {risingFury} from \"./risingFury\";\r\nimport {blaze} from \"./blaze\";\r\nimport {necromancy} from \"./necromancy\";\r\nimport {unity} from \"./unity\";\r\nimport {quickShot} from \"./quickShot\";\r\nimport {rebirth} from \"./rebirth\";\r\nimport {reload} from \"./reload\";\r\nimport {revenge} from \"./revenge\";\r\nimport {ricochet} from \"./ricochet\";\r\nimport {shell} from \"./shell\";\r\nimport {shieldwall} from \"./shieldwall\";\r\nimport {silence} from \"./silence\";\r\nimport {smite} from \"./smite\";\r\nimport {spellweave} from \"./spellweave\";\r\nimport {toxicSpray} from \"./toxicSpray\";\r\nimport {valor} from \"./valor\";\r\nimport {fortitude} from \"./fortitude\";\r\nimport { regeneration } from \"./regeneration\";\r\nimport { leech } from \"./leech\";\r\nimport { electroShock } from \"./electroShock\";\r\nimport { cleanse } from \"./cleanse\";\r\nimport { tidalWave } from \"./tidalWave\";\r\nimport { retribution } from \"./retribution\";\r\nimport { corrosiveTouch } from \"./corrosiveTouch\";\r\nimport { toxicGas } from \"./toxicGas\";\r\nimport { acidRain } from \"./acidRain\";\r\nimport { smokeBomb } from \"./smokeBomb\";\r\nimport { contaminatedAir } from \"./contaminatedAir\";\r\nimport { noxiousFumes } from \"./noxiousFumes\";\r\nimport { poisonedGround } from \"./poisonedGround\";\r\nimport { selfDestruct } from \"./selfDestruct\";\r\nimport { rampage } from \"./rampage\";\r\nimport { backstab } from \"./backstab\";\r\nimport { overpower } from \"./overpower\";\r\nimport { ignite } from \"./ignite\";\r\nimport { corruption } from \"./corruption\";\r\nimport { hysteria } from \"./hysteria\";\r\nimport { explosive } from \"./explosive\";\r\nimport { reflection } from \"./reflection\";\r\nimport { constriction } from \"./constriction\";\r\n\r\nexport {mirrorsEdge};\r\n\r\nconst effect = {\r\n  acidicDeath,\r\n  acidRain,\r\n  banish,\r\n  backstab,\r\n  cleanse,\r\n  corrosiveTouch,\r\n  contaminatedAir,\r\n  shadowSurge,\r\n  diminish,\r\n  electroShock,\r\n  fortitude,\r\n  frostbite,\r\n  glory,\r\n  heartOfSteel,\r\n  lastStand,\r\n  leech,\r\n  mirrorsEdge,\r\n  risingFury,\r\n  blaze,\r\n  necromancy,\r\n  unity,\r\n  silence,\r\n  quickShot,\r\n  shieldwall,\r\n  smite,\r\n  spellweave,\r\n  rebirth,\r\n  regeneration,\r\n  retribution,\r\n  reload,\r\n  revenge,\r\n  ricochet,\r\n  shell,\r\n  toxicGas,\r\n  toxicSpray,\r\n  tidalWave,\r\n  valor,\r\n  smokeBomb,\r\n  noxiousFumes,\r\n  poisonedGround,\r\n  selfDestruct,\r\n  rampage,\r\n  overpower,\r\n  ignite,\r\n  corruption,\r\n  hysteria,\r\n  explosive,\r\n  reflection,\r\n  constriction,\r\n};\r\n\r\nexport {effect};\r\n","import type {Game} from \"@som/shared/types/mongo\";\r\nimport type {GameView} from \"@som/shared/types/views\";\r\n\r\ntype GenerateGameView = (game: Game, name: string) => GameView;\r\n\r\nconst generateGameView: GenerateGameView = ({\r\n  id,\r\n  type,\r\n  currentPlayer,\r\n  currentTurn,\r\n  gameLogs,\r\n  playerA,\r\n  playerB\r\n}, name) => ({\r\n  id,\r\n  type,\r\n  currentPlayer,\r\n  currentTurn,\r\n  gameLogs,\r\n  player: playerA.name === name ? {\r\n    name: playerA.name,\r\n    // hero: playerA.hero,\r\n    // minion: playerA.minion,\r\n    field: playerA.field,\r\n    trap: playerA.trap,\r\n    deck: playerA.deck.length,\r\n    hand: playerA.hand,\r\n    graveyard: playerA.graveyard,\r\n    skins: playerA.skins\r\n  } : {\r\n    name: playerB.name,\r\n    // hero: playerB.hero,\r\n    // minion: playerB.minion,\r\n    field: playerB.field,\r\n    trap: playerB.trap,\r\n    deck: playerB.deck.length,\r\n    hand: playerB.hand,\r\n    graveyard: playerB.graveyard,\r\n    skins: playerB.skins\r\n  },\r\n  opponent: playerA.name === name ? {\r\n    name: playerB.name,\r\n    // hero: playerB.hero,\r\n    // minion: playerB.minion,\r\n    field: playerB.field,\r\n    trap: playerB.trap ? true : false,\r\n    deck: playerB.deck.length,\r\n    hand: playerB.hand.length,\r\n    graveyard: playerB.graveyard,\r\n    skins: playerB.skins\r\n  } : {\r\n    name: playerA.name,\r\n    // hero: playerA.hero,\r\n    // minion: playerA.minion,\r\n    field: playerA.field,\r\n    trap: playerA.trap ? true : false,\r\n    deck: playerA.deck.length,\r\n    hand: playerA.hand.length,\r\n    graveyard: playerA.graveyard,\r\n    skins: playerA.skins\r\n  }\r\n});\r\n\r\nexport {generateGameView};\r\n","import {mongo, server} from \"app\";\r\nimport {generateGameView} from \"./generateGameView\";\r\nimport type {Animations} from \"@som/shared/types/game\";\r\nimport type {Game} from \"@som/shared/types/mongo\";\r\n\r\nconst attackMinionSave = async ($game: Game, animations: Animations): Promise<void> => {\r\n  const {$players, $games} = mongo;\r\n  const {io} = server;\r\n  const {playerA, playerB} = $game;\r\n  const [$playerA, $playerB] = await Promise.all([\r\n    $players.findOne({\r\n      name: playerA.name\r\n    }),\r\n    $players.findOne({\r\n      name: playerB.name\r\n    })\r\n  ]);\r\n\r\n  if (!$playerA || !$playerB) {\r\n    return;\r\n  }\r\n\r\n  io.to($playerA.socketId).emit(\"attackMinionSave\", {\r\n    game: generateGameView($game, $playerA.name),\r\n    animations\r\n  });\r\n\r\n  io.to($playerB.socketId).emit(\"attackMinionSave\", {\r\n    game: generateGameView($game, $playerB.name),\r\n    animations\r\n  });\r\n\r\n  // await $games.replaceOne({id: $game.id}, $game);\r\n};\r\n\r\nexport {attackMinionSave};\r\n","import {randomInt} from \"crypto\";\r\nimport {cards} from \"@som/shared/data\";\r\nimport {CardType} from \"@som/shared/enums\";\r\n\r\nimport type {\r\n  GameCards,\r\n  GameMagicCard,\r\n  GameMinionCard,\r\n  GameTrapCard,\r\n  PlayerDeck\r\n} from \"@som/shared/types/mongo\";\r\n\r\nconst buildDeck = (deck: PlayerDeck): GameCards => {\r\n  const gameDeck: GameCards = [];\r\n  let gid = 1;\r\n\r\n  deck.cards.forEach((deckCard) => {\r\n    const card = cards.find((card) => card.id === deckCard.id);\r\n\r\n    if (!card) {\r\n      console.error(\"One of the cards in the deck is invalid.\");\r\n      return;\r\n    }\r\n\r\n    if (card.type === CardType.HERO) {\r\n      console.error(\"Hero cannot be a deck card.\")\r\n      return;\r\n    }\r\n\r\n    const {id, klass, effect, manaCost} = card;\r\n    let gameCard: GameMagicCard | GameMinionCard | GameTrapCard;\r\n\r\n    if (card.type === CardType.MINION) {\r\n      const {type, health, damage} = card;\r\n\r\n      gameCard = {\r\n        id,\r\n        gid,\r\n        klass,\r\n        effect,\r\n        type,\r\n        health,\r\n        damage,\r\n        manaCost,\r\n        maxHealth: health,\r\n        canAttack: false,\r\n        buffs: [],\r\n        debuffs: []\r\n      };\r\n    } else {\r\n      const {type} = card;\r\n      gameCard = {id, gid, klass, effect, type, manaCost};\r\n    }\r\n\r\n    gameDeck.push(gameCard);\r\n    gid += 1;\r\n\r\n    if (deckCard.amount > 1) {\r\n      gameDeck.push({...gameCard, gid});\r\n      gid += 1;\r\n    }\r\n  });\r\n\r\n  for (let i = gameDeck.length - 1; i > 0; i -= 1) {\r\n    const j = randomInt(0, i + 1);\r\n    const temp = gameDeck[i];\r\n\r\n    gameDeck[i] = gameDeck[j];\r\n    gameDeck[j] = temp;\r\n  }\r\n\r\n  return gameDeck;\r\n};\r\n\r\nexport {buildDeck};\r\n","import {GameType, PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\n\r\nconst sleep = (waitTimeInMs: number) => new Promise(resolve => setTimeout(resolve, waitTimeInMs));\r\n\r\nconst endGame = async (gameId: number, winnerName: string): Promise<void> => {\r\n  const {$games, $players} = mongo;\r\n  const {io} = server;\r\n  const $game = await $games.findOne({id: gameId});\r\n\r\n  if (!$game) { return; }\r\n\r\n  const {playerA, playerB} = $game;\r\n\r\n  if (winnerName === playerA.name) {\r\n    const $playerA = await $players.findOne({\r\n      name: playerA.name\r\n    });\r\n    const $playerB = await $players.findOne({\r\n      name: playerB.name\r\n    });\r\n\r\n    if (!$playerA || !$playerB) { return; }\r\n\r\n    $playerA.status = PlayerStatus.ONLINE;\r\n    $playerA.gameId = 0;\r\n    $playerB.status = PlayerStatus.ONLINE;\r\n    $playerB.gameId = 0;\r\n\r\n    if ($game.type === GameType.CASUAL || $game.type === GameType.RANKED) {\r\n      $playerA.experience += 110 + $game.currentTurn;\r\n\r\n      const aReq = 1000 + ($playerA.level % 10) * 100;\r\n      if ($playerA.experience >= aReq) {\r\n        const rem = $playerA.experience - aReq;\r\n        $playerA.level += 1;\r\n        $playerA.experience = rem;\r\n        // call levelup on chain, and save returned values, emit with gameEnded\r\n      }\r\n\r\n      $playerB.experience += 90 + $game.currentTurn;\r\n\r\n      const bReq = 1000 + ($playerB.level % 10) * 100;\r\n      if ($playerB.experience >= bReq) {\r\n        const rem = $playerB.experience - bReq;\r\n        $playerB.level += 1;\r\n        $playerB.experience = rem;\r\n        // call levelup on chain, and save returned values, emit with gameEnded\r\n      }\r\n    }\r\n\r\n    if ($game.type === GameType.CASUAL) {\r\n      $playerA.games.casual.won += 1;\r\n      $playerB.games.casual.lost += 1;\r\n    }\r\n\r\n    if ($game.type === GameType.RANKED) {\r\n      $playerA.games.ranked.won += 1;\r\n      $playerB.games.ranked.lost += 1;\r\n      $playerA.elo += 20;\r\n      $playerB.elo -= 20;\r\n    }\r\n\r\n    const $playerAReplace = await $players.replaceOne({\r\n      name: playerA.name\r\n    }, $playerA);\r\n\r\n    const $playerBReplace = await $players.replaceOne({\r\n      name: playerB.name\r\n    }, $playerB);\r\n\r\n    io.to($playerA.socketId).emit(\"gameEnded\" as any, {\r\n      isWinner: true,\r\n      gameType: $game.type,\r\n      experience: 110 + $game.currentTurn,\r\n      elo: $game.type === GameType.RANKED ? 20 : 0\r\n    });\r\n\r\n    io.to($playerB.socketId).emit(\"gameEnded\" as any, {\r\n      isWinner: false,\r\n      gameType: $game.type,\r\n      experience: 90 + $game.currentTurn,\r\n      elo: $game.type === GameType.RANKED ? -20 : 0\r\n    });\r\n\r\n\r\n\r\n  } else if (winnerName === playerB.name) {\r\n\r\n\r\n\r\n    const $playerB = await $players.findOne({\r\n      name: playerB.name\r\n    });\r\n    const $playerA = await $players.findOne({\r\n      name: playerA.name\r\n    });\r\n\r\n    if (!$playerB || !$playerA) { return; }\r\n\r\n    $playerB.status = PlayerStatus.ONLINE;\r\n    $playerB.gameId = 0;\r\n    $playerA.status = PlayerStatus.ONLINE;\r\n    $playerA.gameId = 0;\r\n\r\n    if ($game.type === GameType.CASUAL || $game.type === GameType.RANKED) {\r\n      $playerB.experience += 110 + $game.currentTurn;\r\n\r\n      const bReq = 1000 + ($playerB.level % 10) * 100;\r\n      if ($playerB.experience >= bReq) {\r\n        const rem = $playerB.experience - bReq;\r\n        $playerB.level += 1;\r\n        $playerB.experience = rem;\r\n        // call levelup on chain, and save returned values, emit with gameEnded\r\n      }\r\n\r\n      $playerA.experience += 90 + $game.currentTurn;\r\n\r\n      const aReq = 1000 + ($playerA.level % 10) * 100;\r\n      if ($playerA.experience >= aReq) {\r\n        const rem = $playerA.experience - aReq;\r\n        $playerA.level += 1;\r\n        $playerA.experience = rem;\r\n        // call levelup on chain, and save returned values, emit with gameEnded\r\n      }\r\n    }\r\n\r\n    if ($game.type === GameType.CASUAL) {\r\n      $playerB.games.casual.won += 1;\r\n      $playerA.games.casual.lost += 1;\r\n    }\r\n\r\n    if ($game.type === GameType.RANKED) {\r\n      $playerB.games.ranked.won += 1;\r\n      $playerA.games.ranked.lost += 1;\r\n      $playerB.elo += 20;\r\n      $playerA.elo -= 20;\r\n    }\r\n\r\n    const $playerBeplace = await $players.replaceOne({\r\n      name: playerB.name\r\n    }, $playerB);\r\n\r\n    const $playerAReplace = await $players.replaceOne({\r\n      name: playerA.name\r\n    }, $playerA);\r\n\r\n    io.to($playerB.socketId).emit(\"gameEnded\" as any, {\r\n      isWinner: true,\r\n      gameType: $game.type,\r\n      experience: 110 + $game.currentTurn,\r\n      elo: $game.type === GameType.RANKED ? 20 : 0\r\n    });\r\n\r\n    io.to($playerA.socketId).emit(\"gameEnded\" as any, {\r\n      isWinner: false,\r\n      gameType: $game.type,\r\n      experience: 90 + $game.currentTurn,\r\n      elo: $game.type === GameType.RANKED ? -20 : 0\r\n    });\r\n  }\r\n\r\n  const isDeletedGame = await $games.deleteOne({id: gameId});\r\n\r\n  if (!isDeletedGame.deletedCount) { return; }\r\n};\r\n\r\nexport {endGame};\r\n","import {endGame} from \"./endGame\";\r\nimport type {Game, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\nconst drawCard = async (\r\n  game: Game,\r\n  player: GamePlayer,\r\n  opponent: GamePlayer\r\n): Promise<void> => {\r\n  const card = opponent.deck.pop();\r\n\r\n  if (!card) {\r\n    return await endGame(game.id, player.name);\r\n  }\r\n\r\n  opponent.hand.push(card);\r\n};\r\n\r\nexport {drawCard};\r\n","import {randomInt} from \"crypto\";\r\nimport {GameType, PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\n\r\nconst gamePopup = async (type: GameType, playerA: string, playerB: string) => {\r\n  const {$gamePopups, $players} = mongo;\r\n  const {io} = server;\r\n  const id = randomInt(1, 1000000001);\r\n\r\n  const [a, b] = await Promise.all([\r\n    $players.findOneAndUpdate({\r\n      name: playerA\r\n    }, {\r\n      $set: {\r\n        gamePopupId: id\r\n      }\r\n    }, {\r\n      returnDocument: \"after\"\r\n    }),\r\n    $players.findOneAndUpdate({\r\n      name: playerB\r\n    }, {\r\n      $set: {\r\n        gamePopupId: id\r\n      }\r\n    }, {\r\n      returnDocument: \"after\"\r\n    })\r\n  ]);\r\n\r\n  if (!a || !b) {\r\n    return;\r\n  }\r\n\r\n  const inserted = await $gamePopups.insertOne({\r\n    id,\r\n    type,\r\n    playerA: {\r\n      name: a.name,\r\n      avatarId: 1,\r\n      level: a.level,\r\n      elo: a.elo,\r\n      hasAccepted: false\r\n    },\r\n    playerB: {\r\n      name: b.name,\r\n      avatarId: 1,\r\n      level: b.level,\r\n      elo: b.elo,\r\n      hasAccepted: false\r\n    }\r\n  });\r\n\r\n  if (!inserted.insertedId) {\r\n    return;\r\n  }\r\n\r\n  const acceptTimeout = setTimeout(async () => {\r\n    const $gamePopup = await $gamePopups.findOne({id});\r\n    if (!$gamePopup) { return; }\r\n    if (!$gamePopup.playerA.hasAccepted || !$gamePopup.playerB.hasAccepted) {\r\n      \r\n      const pa = await $players.findOneAndUpdate({\r\n        name: $gamePopup.playerA.name\r\n      }, {\r\n        $set: {\r\n          status: PlayerStatus.ONLINE,\r\n          gamePopupId: 0\r\n        }\r\n      });\r\n      const pb = await $players.findOneAndUpdate({\r\n        name: $gamePopup.playerB.name\r\n      }, {\r\n        $set: {\r\n          status: PlayerStatus.ONLINE,\r\n          gamePopupId: 0\r\n        }\r\n      });\r\n\r\n      if (!pa || !pb) { return; }\r\n\r\n      await $gamePopups.deleteOne({id});\r\n\r\n      io.to(pa.socketId).emit(\"declineGame\");\r\n      io.to(pb.socketId).emit(\"declineGame\");\r\n    }\r\n  }, 10_000);\r\n\r\n  io.to(a.socketId).emit(\"gamePopup\");\r\n  io.to(b.socketId).emit(\"gamePopup\");\r\n};\r\n\r\nexport {gamePopup};\r\n","import {cards} from \"@som/shared/data\";\r\nimport {CardType, GameType} from \"@som/shared/enums\";\r\nimport {buildDeck} from \"./buildDeck\";\r\n\r\nimport type {\r\n  Game,\r\n  GameCards,\r\n  GameHeroCard,\r\n  Player\r\n} from \"@som/shared/types/mongo\";\r\n\r\nimport type {Game, Player} from \"@som/shared/types/backend\";\r\n\r\nconst generateGame = (\r\n  id: number,\r\n  type: GameType,\r\n  playerA: Player,\r\n  playerB: Player\r\n): Game => {\r\n  const playerASelectedDeck = playerA.decks.find(({id}) => id === playerA.deckId);\r\n  const playerBSelectedDeck = playerB.decks.find(({id}) => id === playerB.deckId);\r\n\r\n  if (!playerASelectedDeck || !playerBSelectedDeck) { return {} as Game; }\r\n\r\n  const playerAHand: GameCards = [];\r\n  const playerBHand: GameCards = [];\r\n  let playerADeck = buildDeck(playerASelectedDeck);\r\n  let playerBDeck = buildDeck(playerBSelectedDeck);\r\n\r\n  if (playerADeck.length !== 30 || playerBDeck.length !== 30) { return {} as Game; }\r\n\r\n  playerAHand.push(...playerADeck.slice(-5));\r\n  playerADeck = playerADeck.slice(0, -5);\r\n  playerBHand.push(...playerBDeck.slice(-5));\r\n  playerBDeck = playerBDeck.slice(0, -5);\r\n\r\n  const playerAHero = cards.find(({type, klass}) => klass === playerASelectedDeck.klass && type === CardType.HERO) as GameHeroCard;\r\n  const playerBHero = cards.find(({type, klass}) => klass === playerBSelectedDeck.klass && type === CardType.HERO) as GameHeroCard;\r\n\r\n  if (!playerAHero || !playerBHero) {\r\n    return {} as Game;\r\n  }\r\n\r\n  return {\r\n    id,\r\n    type,\r\n    currentPlayer: playerA.name,\r\n    currentTurn: 0,\r\n    gameLogs: [],\r\n    playerA: {\r\n      name: playerA.name,\r\n      field: {\r\n        hero: {\r\n          ...playerAHero,\r\n          maxHealth: 20,\r\n          maxMana: 10,\r\n          buffs: [],\r\n          debuffs: []\r\n        },\r\n        a: undefined,\r\n        b: undefined,\r\n        c: undefined,\r\n        d: undefined\r\n      },\r\n      trap: undefined,\r\n      hand: playerAHand,\r\n      deck: playerADeck,\r\n      graveyard: [],\r\n      skins: playerA.skins\r\n    },\r\n    playerB: {\r\n      name: playerB.name,\r\n      field: {\r\n        hero: {\r\n          ...playerBHero,\r\n          maxHealth: 20,\r\n          maxMana: 10,\r\n          buffs: [],\r\n          debuffs: []\r\n        },\r\n        a: undefined,\r\n        b: undefined,\r\n        c: undefined,\r\n        d: undefined\r\n      },\r\n      trap: undefined,\r\n      hand: playerBHand,\r\n      deck: playerBDeck,\r\n      graveyard: [],\r\n      skins: playerB.skins\r\n    },\r\n  };\r\n};\r\n\r\nexport {generateGame};\r\n","import {mongo} from \"app\";\r\nimport type {WithId} from \"mongodb\";\r\nimport type {Game, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\ninterface Response {\r\n  $game: WithId<Game>;\r\n  player: GamePlayer;\r\n  opponent: GamePlayer;\r\n}\r\n\r\ntype GetGame = (socketId: string) => Promise<[Response | undefined, string]>;\r\n\r\nconst getGame: GetGame = async (socketId) => {\r\n  const {$games, $players} = mongo;\r\n  const $player = await $players.findOne({socketId});\r\n\r\n  if (!$player) {\r\n    return [, \"Player not found, try relogging.\"];\r\n  }\r\n\r\n  const {name} = $player;\r\n  const id = $player.gameId;\r\n  const $game = await $games.findOne({id});\r\n\r\n  if (!$game) {\r\n    return [, \"Game not found.\"];\r\n  }\r\n\r\n  const {playerA, playerB} = $game;\r\n  const player = playerA.name === name ? playerA : playerB;\r\n  const opponent = playerA.name === name ? playerB : playerA;\r\n\r\n  if ($game.currentPlayer !== player.name) {\r\n    return [, \"It's not your turn.\"];\r\n  }\r\n\r\n  return [{$game, player, opponent}, \"\"];\r\n};\r\n\r\nexport {getGame};\r\n","import {CardType} from \"@som/shared/enums\";\r\nimport {randomInt} from \"crypto\";\r\nimport type {GameMinionCard, GamePlayer} from \"@som/shared/types/mongo\";\r\n\r\nconst getRandomMinion = (player: GamePlayer): GameMinionCard | undefined => {\r\n  const list: Array<GameMinionCard> = [];\r\n  const fields = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n  fields.forEach((field) => {\r\n    const minion = player.field[field];\r\n\r\n    if (minion && minion.type !== CardType.HERO) {\r\n      list.push(minion);\r\n    }\r\n  });\r\n\r\n  return list[randomInt(list.length)];\r\n};\r\n\r\nexport {getRandomMinion};\r\n","import {endGame} from \"./endGame\";\r\nimport type {Game} from \"@som/shared/types/mongo\";\r\n\r\nconst isGameOver = async (game: Game): Promise<boolean> => {\r\n  if (game.playerA.field.hero.health <= 0) {\r\n    await endGame(game.id, game.playerB.name);\r\n    return true;\r\n  } else if (game.playerB.field.hero.health <= 0) {\r\n    await endGame(game.id, game.playerA.name);\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nexport {isGameOver};\r\n","import {mongo, server} from \"app\";\r\nimport {generateGameView} from \"./generateGameView\";\r\nimport type {Game} from \"@som/shared/types/mongo\";\r\n\r\nconst saveGame = async (game: Game): Promise<void> => {\r\n  const {$games, $players} = mongo;\r\n  const {io} = server;\r\n  const {id, playerA, playerB} = game;\r\n\r\n  const [$updateGame, $playerA, $playerB] = await Promise.all([\r\n    $games.replaceOne({id}, game),\r\n    $players.findOne({\r\n      name: playerA.name\r\n    }),\r\n    $players.findOne({\r\n      name: playerB.name\r\n    })\r\n  ]);\r\n\r\n  if (!$updateGame.modifiedCount || !$playerA || !$playerB) { return; }\r\n\r\n  io.to($playerA.socketId).emit(\"reloadGameState\", {\r\n    game: generateGameView(game, $playerA.name)\r\n  });\r\n\r\n  io.to($playerB.socketId).emit(\"reloadGameState\", {\r\n    game: generateGameView(game, $playerB.name)\r\n  });\r\n};\r\n\r\nexport {saveGame};\r\n","import {GameType, PlayerStatus, QueueId} from \"@som/shared/enums\";\nimport {mongo, server} from \"app\";\nimport {generateGame} from \"./generateGame\";\nimport {generateGameView} from \"./generateGameView\";\n\nconst startGame = async (\n  id: number,\n  type: GameType,\n  playerA: string,\n  playerB: string\n): Promise<void> => {\n  const {$accounts, $games, $players} = mongo;\n  const {io} = server;\n  const [$playerA, $playerB, $accountA, $accountB] = await Promise.all([\n    $players.findOneAndUpdate({\n      name: playerA\n    }, {\n      $set: {\n        status: PlayerStatus.IN_GAME,\n        queueId: QueueId.NONE,\n        lobbyId: 0,\n        gamePopupId: 0,\n        gameId: id\n      }\n    }),\n    $players.findOneAndUpdate({\n      name: playerB\n    }, {\n      $set: {\n        status: PlayerStatus.IN_GAME,\n        queueId: QueueId.NONE,\n        lobbyId: 0,\n        gamePopupId: 0,\n        gameId: id\n      }\n    }),\n    $accounts.findOne({\n      name: playerA\n    }),\n    $accounts.findOne({\n      name: playerB\n    }),\n  ]);\n\n  if (!$playerA || !$playerB || !$accountA || !$accountB) {\n    return;\n  }\n\n  const game = generateGame(id, type, $playerA, $playerB);\n  const isInserted = await $games.insertOne(game);\n\n  if (!isInserted.insertedId) {\n    return;\n  }\n\n  io.to($playerA.socketId).emit(\"startGame\" as any, {\n    playerA: {\n      name: $playerA.name,\n      avatarId: $accountA.avatarId,\n      level: $playerA.level,\n      elo: $playerA.elo\n    },\n    playerB: {\n      name: $playerB.name,\n      avatarId: $accountB.avatarId,\n      level: $playerB.level,\n      elo: $playerB.elo\n    },\n    game: generateGameView(game, $playerA.name)\n  });\n\n  io.to($playerB.socketId).emit(\"startGame\" as any, {\n    playerA: {\n      name: $playerA.name,\n      avatarId: $accountA.avatarId,\n      level: $playerA.level,\n      elo: $playerA.elo\n    },\n    playerB: {\n      name: $playerB.name,\n      avatarId: $accountB.avatarId,\n      level: $playerB.level,\n      elo: $playerB.elo\n    },\n    game: generateGameView(game, $playerB.name)\n  });\n};\n\nexport {startGame};\n\n","import {effect} from \"./effect\";\r\nimport {attackMinionSave} from \"./attackMinionSave\";\r\nimport {buildDeck} from \"./buildDeck\";\r\nimport {deductHealth} from \"./deductHealth\";\r\nimport {drawCard} from \"./drawCard\";\r\nimport {endGame} from \"./endGame\";\r\nimport {gamePopup} from \"./gamePopup\";\r\nimport {generateGame} from \"./generateGame\";\r\nimport {generateGameView} from \"./generateGameView\";\r\nimport {getAdjacentMinions} from \"./getAdjacentMinions\";\r\nimport {getGame} from \"./getGame\";\r\nimport {getRandomMinion} from \"./getRandomMinion\";\r\nimport {insertBuff} from \"./insertBuff\";\r\nimport {insertDebuff} from \"./insertDebuff\";\r\nimport {isGameOver} from \"./isGameOver\";\r\nimport {moveToGraveyard} from \"./moveToGraveyard\";\r\nimport {saveGame} from \"./saveGame\";\r\nimport {startGame} from \"./startGame\";\r\n\r\nconst gameHelpers = {\r\n  effect,\r\n  attackMinionSave,\r\n  buildDeck,\r\n  deductHealth,\r\n  drawCard,\r\n  endGame,\r\n  gamePopup,\r\n  generateGame,\r\n  generateGameView,\r\n  getAdjacentMinions,\r\n  getGame,\r\n  getRandomMinion,\r\n  insertBuff,\r\n  insertDebuff,\r\n  isGameOver,\r\n  moveToGraveyard,\r\n  saveGame,\r\n  startGame,\r\n};\r\n\r\nexport {gameHelpers};\r\n","import {mongo} from \"app\";\r\n\r\nconst getSocketIds = async (players: string[]): Promise<string[]> => {\r\n  return await mongo\r\n    .$players\r\n    .find({name: {$in: players}})\r\n    .project({_id: 0, socketId: 1})\r\n    .map(({socketId}) => socketId)\r\n    .toArray();\r\n};\r\n\r\nexport {getSocketIds};\r\n","import type {PlayerDeck} from \"@som/shared/types/mongo\";\r\n\r\nconst isDeckValid = (playerDeck: PlayerDeck): boolean => {\r\n  const numberOfCards = playerDeck\r\n    .cards\r\n    .reduce((value, {amount}) => value += amount, 0);\r\n\r\n  if (numberOfCards !== 30) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nexport {isDeckValid};\r\n","import {getSocketIds} from \"./getSocketIds\";\r\nimport {isDeckValid} from \"./isDeckValid\";\r\n\r\nconst playerHelpers = {getSocketIds, isDeckValid};\r\n\r\nexport {playerHelpers};\r\n\r\n","import {PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\nimport {playerHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst disconnect: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"disconnect\", async () => {\r\n    const $playerUpdate = await $players.findOneAndUpdate({socketId}, {\r\n      $set: {\r\n        socketId: \"\",\r\n        status: PlayerStatus.OFFLINE\r\n      }\r\n    }, {\r\n      returnDocument: \"after\"\r\n    });\r\n\r\n    if (!$playerUpdate) {\r\n      return error(\"Error updating player.\");\r\n    }\r\n\r\n    const {name, status} = $playerUpdate;\r\n    const $account = await $accounts.findOne({name});\r\n\r\n    if (!$account) {\r\n      return error(\"Account not found.\");\r\n    }\r\n\r\n    const socketIds = await playerHelpers.getSocketIds($account.social.friends);\r\n    server.io.to(socketIds).emit(\"updateFriend\", {name, status});\r\n  });\r\n};\r\n\r\nexport {disconnect};\r\n","import {compare} from \"bcrypt\"\r\nimport {cards, cardsView} from \"@som/shared/data\";\r\nimport {CardType, PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nimport type {\r\n  AccountView,\r\n  GameView,\r\n  PlayerView\r\n} from \"@som/shared/types/views\";\r\n\r\nconst signin: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $chats, $games, $lobbies, $players} = mongo;\r\n\r\n  socket.on(\"signin\", async (params) => {\r\n    const {name, password} = params;\r\n    let lobby, game: any;\r\n\r\n    const acc = await $accounts.findOne({name});\r\n\r\n    if (!acc) {\r\n      return error(`Account ${name} not found.`);\r\n    }\r\n\r\n    const isCorrectPassword = await compare(password, acc.passwordHash);\r\n\r\n    if (!isCorrectPassword) {\r\n      return error(\"Invalid password.\");\r\n    }\r\n\r\n    const $player = await $players.findOneAndUpdate({name}, [{\r\n      $set: {\r\n        socketId,\r\n        status: {\r\n          $switch: {\r\n            branches: [{\r\n              case: {\r\n                $gt: [\"$lobbyId\", 0]\r\n              },\r\n              then: PlayerStatus.IN_LOBBY\r\n            }, {\r\n              case: {\r\n                $gt: [\"$gameId\", 0]\r\n              },\r\n              then: PlayerStatus.IN_GAME\r\n            }],\r\n            default: PlayerStatus.ONLINE\r\n          }\r\n        }\r\n      }\r\n    }], {\r\n      returnDocument: \"after\"\r\n    });\r\n\r\n    if (!$player) {\r\n      return error(\"Error updating player. xdf\");\r\n    }\r\n\r\n    const friendsView: Array<any> = [];\r\n\r\n    for (const friendname of acc.social.friends) {\r\n      const [friend, friendAcc, chat] = await Promise.all([\r\n        $players.findOne({\r\n          name: friendname\r\n        }),\r\n        $accounts.findOne({\r\n          name: friendname\r\n        }),\r\n        $chats.findOne({\r\n          players: {\r\n            $all: [$player.name, friendname]\r\n          }\r\n        })\r\n      ]);\r\n\r\n      if (!friend || !friendAcc || !chat) { return; }\r\n\r\n      const {status} = friend;\r\n      const {messages} = chat;\r\n\r\n      friendsView.push({name: friendname, status, avatarId: friendAcc?.avatarId, messages});\r\n    }\r\n\r\n    const social = {\r\n      friends: friendsView,\r\n      requests: acc.social.requests,\r\n      blocked: acc.social.blocked,\r\n      chat: {\r\n        name: \"\",\r\n        status: 0,\r\n        avatarId: 0,\r\n        messages: [],\r\n        isOpen: false\r\n      }\r\n    };\r\n\r\n    const {lobbyId, gameId} = $player;\r\n    let gameFrontend: GameView | undefined;\r\n\r\n    if (lobbyId) {\r\n      lobby = await $lobbies.findOne({id: lobbyId});\r\n\r\n      if (!lobby) {\r\n        return error(\"You are currently in a lobby that cannot be found. (Contact dev)\");\r\n      }\r\n    } else if (gameId) {\r\n      game = await $games.findOne({id: gameId});\r\n\r\n      if (!game) {\r\n        return error(\"You are currently in a game that cannot be found. (Contact dev)\");\r\n      }\r\n\r\n      gameFrontend = gameHelpers.generateGameView(game, $player.name);\r\n    }\r\n\r\n    const accountFrontend: AccountView = {\r\n      name,\r\n      publicKey: acc.publicKey,\r\n      avatarId: acc.avatarId,\r\n      bannerId: acc.bannerId,\r\n      social\r\n    };\r\n\r\n    const playerFrontend: PlayerView = {\r\n      name: $player.name,\r\n      experience: $player.experience,\r\n      level: $player.level,\r\n      elo: $player.elo,\r\n      joinedAt: $player.joinedAt,\r\n      status: $player.status,\r\n      queueId: $player.queueId,\r\n      deckId: $player.deckId,\r\n      lobbyId: $player.lobbyId,\r\n      gameId: $player.gameId,\r\n      gamePopupId: $player.gamePopupId,\r\n      games: $player.games,\r\n      decks: $player.decks.map((deck) => ({\r\n        id: deck.id,\r\n        klass: deck.klass,\r\n        name: deck.name,\r\n        cardsInDeck: deck.cards.reduce((acc, {amount}) => acc += amount, 0),\r\n        cards: deck.cards.map((deckCard) => {\r\n          const card = cards.find((card) => deckCard.id === card.id);\r\n\r\n          if (!card || card.type === CardType.HERO) {\r\n            console.log(\"Card not found, deck invalid, hero can't be in deck...?\");\r\n            // this should never happen though...\r\n            return {id: 0, name: \"\", amount: 0, manaCost: 0};\r\n          }\r\n\r\n          const cardView = cardsView.get(card.id);\r\n\r\n          if (!cardView) {\r\n            return {id: 0, name: \"\", amount: 0, manaCost: 0};\r\n          }\r\n\r\n          const {id, amount} = deckCard;\r\n          const {manaCost} = card;\r\n          const {name} = cardView;\r\n\r\n          return {id, name, amount, manaCost};\r\n        })\r\n      })),\r\n      skins: $player.skins,\r\n      tutorial: $player.tutorial\r\n    };\r\n\r\n    socket.emit(\"signin\", {\r\n      accountFrontend,\r\n      playerFrontend,\r\n      lobbyFrontend: lobby as any,\r\n      gameFrontend\r\n    });\r\n  });\r\n};\r\n\r\nexport {signin};\r\n","import {hash} from \"bcrypt\";\r\nimport {cards} from \"@som/shared/data\";\r\nimport {PlayerStatus, QueueId} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst signup: SocketRequest = (socket, error): void => {\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"signup\", async (params) => {\r\n    const {name, password} = params;\r\n\r\n    if (name.length > 16) {\r\n      return error(\"Maximum 16 characters.\");\r\n    }\r\n\r\n    const $account = await $accounts.findOne({name});\r\n\r\n    if ($account) {\r\n      return error(\"Name taken.\");\r\n    }\r\n\r\n    const passwordHash = await hash(password, 12);\r\n\r\n    const [insertAccount, insertPlayer] = await Promise.all([\r\n      $accounts.insertOne({\r\n        name,\r\n        passwordHash,\r\n        publicKey: \"\",\r\n        avatarId: 0,\r\n        bannerId: 0,\r\n        social: {\r\n          friends: [],\r\n          requests: [],\r\n          blocked: []\r\n        }\r\n      }),\r\n      $players.insertOne({\r\n        socketId: \"\",\r\n        name,\r\n        experience: 0,\r\n        level: 1,\r\n        elo: 500,\r\n        joinedAt: Date.now(),\r\n        status: PlayerStatus.OFFLINE,\r\n        queueId: QueueId.NONE,\r\n        deckId: 0,\r\n        lobbyId: 0,\r\n        gameId: 0,\r\n        gamePopupId: 0,\r\n        games: {\r\n          casual: {won: 0, lost: 0},\r\n          ranked: {won: 0, lost: 0}\r\n        },\r\n        decks: [\r\n          {id: 0, klass: 1, name: \"Deck 1\", cards: []},\r\n          {id: 1, klass: 2, name: \"Deck 2\", cards: []},\r\n          {id: 2, klass: 3, name: \"Deck 3\", cards: []},\r\n          {id: 3, klass: 4, name: \"Deck 4\", cards: []}\r\n        ],\r\n        skins: cards.map((card) => ({cardId: card.id, skinId: 0})),\r\n        tutorial: {\r\n          deckBuilder: false,\r\n          game: false,\r\n          play: false,\r\n          inventory: false\r\n        }\r\n      })\r\n    ]);\r\n\r\n    if (!insertAccount.insertedId) {\r\n      if (insertPlayer.insertedId) {\r\n        await $players.deleteOne({\r\n          _id: insertPlayer.insertedId\r\n        });\r\n      }\r\n\r\n      return error(\"Error creating account, please try again.\");\r\n    }\r\n\r\n    if (!insertPlayer.insertedId) {\r\n      if (insertAccount.insertedId) {\r\n        await $accounts.deleteOne({\r\n          _id: insertAccount.insertedId\r\n        });\r\n      }\r\n\r\n      return error(\"Error creating player, please try again.\");\r\n    }\r\n\r\n    socket.emit(\"notification\", \"Account created successfully.\");\r\n  });\r\n};\r\n\r\nexport {signup};\r\n","import {disconnect} from \"./disconnect\";\r\nimport {signin} from \"./signin\";\r\nimport {signup} from \"./signup\";\r\n\r\nconst auth = [disconnect, signin, signup];\r\n\r\nexport {auth};\r\n","import {mongo, server} from \"app\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst acceptGame: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$gamePopups, $players} = mongo;\r\n\r\n  socket.on(\"acceptGame\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const id = $player.gamePopupId;\r\n    const $gamePopup = await $gamePopups.findOne({id});\r\n\r\n    if (!$gamePopup) {\r\n      return error(\"Game popup not found.\");\r\n    }\r\n\r\n    const {type, playerA, playerB} = $gamePopup;\r\n\r\n    if (playerA.hasAccepted || playerB.hasAccepted) {\r\n      const $gamePopupDelete = await $gamePopups.deleteOne({id});\r\n\r\n      if (!$gamePopupDelete.deletedCount) {\r\n        return error(\"Error deleting game popup.\");\r\n      }\r\n\r\n      await gameHelpers.startGame(id, type, playerA.name, playerB.name);\r\n    } else {\r\n      if (playerA.name === $player.name) {\r\n        playerA.hasAccepted = true;\r\n      } else if (playerB.name === $player.name) {\r\n        playerB.hasAccepted = true;\r\n      }\r\n\r\n      const [$playerA, $playerB, $gamePopupReplace] = await Promise.all([\r\n        $players.findOne({\r\n          name: playerA.name\r\n        }),\r\n        $players.findOne({\r\n          name: playerB.name\r\n        }),\r\n        $gamePopups.replaceOne({id}, $gamePopup)\r\n      ]);\r\n\r\n      if (!$playerA || !$playerB) {\r\n        return error(\"Player A in popup not found.\");\r\n      }\r\n\r\n      if (!$playerB) {\r\n        return error(\"Player B in popup not found.\");\r\n      }\r\n\r\n      if (!$gamePopupReplace.modifiedCount) {\r\n        return error(\"Error replacing game popup.\");\r\n      }\r\n\r\n      server.io.to([$playerA.socketId, $playerB.socketId]).emit(\"acceptGame\");\r\n    }\r\n  });\r\n};\r\n\r\nexport {acceptGame};\r\n","import {PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst closeLobby: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$players, $lobbies} = mongo;\r\n\r\n  socket.on(\"closeLobby\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const {name, lobbyId} = $player;\r\n\r\n    if (!lobbyId) {\r\n      return error(\"You are not in a lobby.\");\r\n    }\r\n\r\n    const id = lobbyId;\r\n    const $lobby = await $lobbies.findOne({id});\r\n\r\n    if (!$lobby) {\r\n      return error(\"Lobby not found.\");\r\n    }\r\n\r\n    const {host, challengee} = $lobby;\r\n\r\n    if (host.name !== name) {\r\n      return error(\"You are not the lobby host.\");\r\n    }\r\n\r\n    const [$lobbyDelete, $playerUpdate, $challengeeUpdate] = await Promise.all([\r\n      $lobbies.deleteOne({id}),\r\n      $players.updateOne({socketId}, {\r\n        $set: {\r\n          lobbyId: 0,\r\n          status: PlayerStatus.ONLINE\r\n        }\r\n      }),\r\n      challengee.name && $players.findOneAndUpdate({\r\n        name: challengee.name\r\n      }, {\r\n        $set: {\r\n          lobbyId: 0,\r\n          status: PlayerStatus.ONLINE\r\n        }\r\n      }, {\r\n        returnDocument: \"after\"\r\n      })\r\n    ]);\r\n\r\n    if (!$lobbyDelete.deletedCount) {\r\n      return error(\"Error deleting lobby.\");\r\n    }\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Error updating host.\");\r\n    }\r\n\r\n    if ($challengeeUpdate && !$challengeeUpdate) {\r\n      return error(\"Error updating challengee.\");\r\n    }\r\n\r\n    socket.emit(\"closeLobby\");\r\n\r\n    if (challengee.name) {\r\n      const $challengee = await $players.findOneAndUpdate({\r\n        name: challengee.name\r\n      }, {\r\n        $set: {\r\n          lobbyId: 0,\r\n          status: PlayerStatus.ONLINE\r\n        }\r\n      }, {\r\n        returnDocument: \"after\"\r\n      });\r\n\r\n      if (!$challengee) {\r\n        return error(\"Error updating challengee.\");\r\n      }\r\n\r\n      server.io.to($challengee.socketId).emit(\"closeLobby\");\r\n    }\r\n  });\r\n};\r\n\r\nexport {closeLobby};\r\n","import {randomInt} from \"crypto\";\r\nimport {PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport {playerHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\nimport type {LobbyView} from \"@som/shared/types/views\";\r\n\r\nconst createLobby: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players, $lobbies} = mongo;\r\n\r\n  socket.on(\"createLobby\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n    if ($player.lobbyId) {\r\n      return error(\"Already in a lobby.\");\r\n    }\r\n    if ($player.gameId) {\r\n      return error(\"Can't make a lobby while in game.\");\r\n    }\r\n    if ($player.queueId) {\r\n      return error(\"Can't make a lobby while in queue.\");\r\n    }\r\n    if (!playerHelpers.isDeckValid($player.decks[$player.deckId])) {\r\n      return error(\"Invalid deck.\");\r\n    }\r\n\r\n    const {name} = $player;\r\n    const $account = await $accounts.findOne({name});\r\n\r\n    if (!$account) {\r\n      return error(\"Account not found, try relogging.\");\r\n    }\r\n\r\n    const {avatarId} = $account;\r\n    const id = randomInt(1, 1000000001);\r\n    const lobby: LobbyView = {\r\n      id,\r\n      host: {name, avatarId},\r\n      challengee: {\r\n        name: \"\",\r\n        avatarId: 0\r\n      }\r\n    }\r\n\r\n    const [$lobbyInsert, $playerUpdate] = await Promise.all([\r\n      $lobbies.insertOne(lobby),\r\n      $players.updateOne({socketId}, {\r\n        $set: {\r\n          lobbyId: id,\r\n          status: PlayerStatus.IN_LOBBY\r\n        }\r\n      })\r\n    ]);\r\n\r\n    if (!$lobbyInsert.insertedId) {\r\n      return error(\"Error inserting lobby.\");\r\n    }\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Error updating player.\");\r\n    }\r\n\r\n    socket.emit(\"createLobby\", {lobby});\r\n  });\r\n};\r\n\r\nexport {createLobby};\r\n","import {PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst declineGame: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$gamePopups, $players} = mongo;\r\n  const {io} = server;\r\n\r\n  socket.on(\"declineGame\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const id = $player.gamePopupId;\r\n    const $gamePopup = await $gamePopups.findOne({id});\r\n\r\n    if (!$gamePopup) {\r\n      return error(\"Game popup not found.\");\r\n    }\r\n\r\n    const {playerA, playerB} = $gamePopup;\r\n    const [$gamePopupDelete, $playerA, $playerB] = await Promise.all([\r\n      $gamePopups.deleteOne({id}),\r\n      $players.findOneAndUpdate({\r\n        name: playerA.name\r\n      }, {\r\n        $set: {\r\n          status: PlayerStatus.ONLINE,\r\n          gamePopupId: 0\r\n        }\r\n      }, {\r\n        returnDocument: \"after\"\r\n      }),\r\n      $players.findOneAndUpdate({\r\n        name: playerB.name\r\n      }, {\r\n        $set: {\r\n          status: PlayerStatus.ONLINE,\r\n          gamePopupId: 0\r\n        }\r\n      }, {\r\n        returnDocument: \"after\"\r\n      })\r\n    ]);\r\n\r\n    if (!$gamePopupDelete.deletedCount) {\r\n      return error(\"Failed to delete game popup.\");\r\n    }\r\n\r\n    if (!$playerA) {\r\n      return error(\"Player A in popup not found / updated.\");\r\n    }\r\n\r\n    if (!$playerB) {\r\n      return error(\"Player B in popup not found / updated.\");\r\n    }\r\n\r\n    io.to([\r\n      $playerA.socketId,\r\n      $playerB.socketId\r\n    ]).emit(\"declineGame\");\r\n  });\r\n};\r\n\r\nexport {declineGame};\r\n","import {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst defaultSkin: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$players} = mongo;\r\n\r\n  socket.on(\"defaultSkin\", async (params) => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const {cardId} = params;\r\n    const $playerUpdate = await $players.updateOne({socketId}, {\r\n      $pull: {\r\n        skins: {cardId}\r\n      }\r\n    });\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Failed to set default skin\");\r\n    }\r\n\r\n    socket.emit(\"defaultSkin\", {cardId});\r\n  });\r\n};\r\n\r\nexport {defaultSkin};\r\n","import {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst finishTutorial: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$players} = mongo;\r\n\r\n  socket.on(\"finishTutorial\", async (params) => {\r\n    const {tutorial} = params;\r\n\r\n    if (\r\n      tutorial !== \"deckBuilder\" &&\r\n      tutorial !== \"inventory\" &&\r\n      tutorial !== \"play\"\r\n    ) {\r\n      return error(\"Invalid tutorial.\");\r\n    }\r\n\r\n    const $playerUpdate = await $players.updateOne({socketId}, {\r\n      $set: {\r\n        [`tutorial.${tutorial}`]: true\r\n      }\r\n    });\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Failed to update player.\");\r\n    }\r\n\r\n    socket.emit(\"finishTutorial\", {tutorial});\r\n  });\r\n};\r\n\r\nexport {finishTutorial};\r\n","import {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\n/**\r\n  * Call the below functionality once per hour / day, sort & store in mongodb.\r\n  * On signin event query the mongodb for sorted leaderboards and emit.\r\n  * Frontend should be able to re-query on leaderboards change (emit to all?).\r\n  * This event should then be removed.\r\n**/\r\n\r\nconst getLeaderboards: SocketRequest = (socket, error): void => {\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"getLeaderboards\", async () => {\r\n    const byLevel = (await $players\r\n      .find()\r\n      .limit(100)\r\n      .sort({\r\n        level: -1\r\n      })\r\n      .toArray()\r\n    ).map(({name, level}) => ({name, level, avatarId: 1}));\r\n\r\n    for (let i = 0; i < byLevel.length; i += 1) {\r\n      const $account = await $accounts.findOne({name: byLevel[i].name});\r\n      if (!$account) { return; }\r\n      const {avatarId} = $account;\r\n      byLevel[i].avatarId = avatarId;\r\n    }\r\n\r\n    const byElo = (await $players\r\n      .find()\r\n      .limit(100)\r\n      .sort({\r\n        elo: -1\r\n      })\r\n      .toArray()\r\n    ).map(({name, elo}) => ({name, elo, avatarId: 1}));\r\n\r\n    for (let i = 0; i < byElo.length; i += 1) {\r\n      const $account = await $accounts.findOne({name: byElo[i].name});\r\n      if (!$account) { return; }\r\n      const {avatarId} = $account;\r\n      byElo[i].avatarId = avatarId;\r\n    }\r\n\r\n    socket.emit(\"getLeaderboards\", {byLevel, byElo});\r\n  });\r\n};\r\n\r\nexport {getLeaderboards};\r\n","import {PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\nimport {playerHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\nimport type {LobbyView} from \"@som/shared/types/views\";\r\n\r\nconst joinLobby: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $lobbies, $players} = mongo;\r\n\r\n  socket.on(\"joinLobby\", async (params) => {\r\n    const {id} = params;\r\n    const [$player, $lobby] = await Promise.all([\r\n      $players.findOne({socketId}),\r\n      $lobbies.findOne({id})\r\n    ]);\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found.\");\r\n    }\r\n\r\n    if (!$lobby) {\r\n      return error(\"Lobby not found.\");\r\n    }\r\n\r\n    if ($player.lobbyId) {\r\n      return error(\"You are already in a lobby.\");\r\n    }\r\n\r\n    if ($player.gameId) {\r\n      return error(\"You can't join a lobby while in game.\");\r\n    }\r\n\r\n    if ($lobby.challengee.name) {\r\n      return error(\"Lobby is full.\");\r\n    }\r\n\r\n    if (!playerHelpers.isDeckValid($player.decks[$player.deckId])) {\r\n      return error(\"Invalid deck.\");\r\n    }\r\n\r\n    const {name} = $player;\r\n    const $account = await $accounts.findOne({name});\r\n\r\n    if (!$account) {\r\n      return error(\"Eternitas account not found for player.\");\r\n    }\r\n\r\n    const {avatarId} = $account;\r\n\r\n    const [$lobbyUpdate, $playerUpdate, $playerHost] = await Promise.all([\r\n      $lobbies.findOneAndUpdate({id}, {\r\n        $set: {\r\n          challengee: {name, avatarId}\r\n        }\r\n      }, {\r\n        returnDocument: \"after\"\r\n      }),\r\n      $players.updateOne({socketId}, {\r\n        $set: {\r\n          lobbyId: id,\r\n          status: PlayerStatus.IN_LOBBY\r\n        }\r\n      }),\r\n      $players.findOne({\r\n        name: $lobby.host.name\r\n      })\r\n    ]);\r\n\r\n    if (!$lobbyUpdate) {\r\n      return error(\"Error updating lobby.\");\r\n    }\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n     return error(\"Error updating player.\");\r\n    }\r\n\r\n    if (!$playerHost) {\r\n      return error(\"Lobby host not found.\");\r\n    }\r\n\r\n    const {host, challengee} = $lobbyUpdate;\r\n    const lobby: LobbyView = {id, host, challengee};\r\n\r\n    socket.emit(\"joinLobbySender\", {lobby});\r\n    server.io.to($playerHost.socketId).emit(\"joinLobbyReceiver\", {challengee});\r\n  });\r\n};\r\n\r\nexport {joinLobby};\r\n","import {GameType, PlayerStatus, QueueId} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst joinQueue: SocketRequest = (socket, error): void => {\r\n  const {$casualQueuePlayers, $players, $rankedQueuePlayers} = mongo;\r\n  const socketId = socket.id;\r\n\r\n  socket.on(\"joinQueue\", async (params) => {\r\n    const {queueId} = params;\r\n\r\n    if (!(queueId in QueueId) || queueId === QueueId.NONE) {\r\n      return error(\"Invalid queue selected.\");\r\n    }\r\n\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found.\");\r\n    }\r\n\r\n    if ($player.queueId) {\r\n      return error(\"You are already in a queue.\");\r\n    }\r\n\r\n    if ($player.lobbyId) {\r\n      return error(\"Can't join queue while in lobby.\");\r\n    }\r\n\r\n    if ($player.gameId) {\r\n      return error(\"Can't join queue while in game.\");\r\n    }\r\n\r\n    if ($player.gamePopupId) {\r\n      return error(\"Can't join queue while in game popup.\");\r\n    }\r\n\r\n    const {name, level, elo} = $player;\r\n\r\n    if (queueId === QueueId.CASUAL) {\r\n      const opponents = await $casualQueuePlayers.find().toArray();\r\n\r\n      for (const opponent of opponents) { // maybe create an interval and loop every 20 seconds for matchmaking\r\n        if (opponent.level < level - 100 || opponent.level < level + 100) {\r\n          const $casualQueuePlayerDelete = await $casualQueuePlayers.deleteOne({\r\n            name: opponent.name\r\n          });\r\n          const $playerUpdate = await $players.updateOne({\r\n            name: opponent.name\r\n          }, {\r\n            $set: {\r\n              queueId: QueueId.NONE\r\n            }\r\n          });\r\n          const $playerUpdate2 = await $players.updateOne({\r\n            name\r\n          }, {\r\n            $set: {\r\n              queueId: QueueId.NONE\r\n            }\r\n          });\r\n\r\n          if (!$casualQueuePlayerDelete.deletedCount || !$playerUpdate.modifiedCount) {\r\n            return error(\"Failed removing player from queue after match found.\");\r\n          }\r\n\r\n          await gameHelpers.gamePopup(GameType.CASUAL, opponent.name, name);\r\n\r\n          return;\r\n        }\r\n      }\r\n\r\n      const $casualQueuePlayerInsert = await $casualQueuePlayers.insertOne({name, level});\r\n\r\n      if (!$casualQueuePlayerInsert.insertedId) {\r\n        return error(\"Failed to insert player in the queue.\");\r\n      }\r\n    } else if (queueId === QueueId.RANKED) {\r\n      const opponents = await $rankedQueuePlayers.find().toArray();\r\n\r\n      for (const opponent of opponents) {\r\n        if (opponent.elo < elo - 11250 || opponent.elo < elo + 11250) {\r\n          const $casualQueuePlayerDelete = await $rankedQueuePlayers.deleteOne({\r\n            name: opponent.name\r\n          });\r\n          const $playerUpdate = await $players.updateOne({\r\n            name: opponent.name\r\n          }, {\r\n            $set: {\r\n              queueId: QueueId.NONE\r\n            }\r\n          });\r\n          const $playerUpdate2 = await $players.updateOne({\r\n            name\r\n          }, {\r\n            $set: {\r\n              queueId: QueueId.NONE\r\n            }\r\n          });\r\n\r\n          if (!$casualQueuePlayerDelete.deletedCount || !$playerUpdate.modifiedCount) {\r\n            return error(\"Failed removing player from queue after match found.\");\r\n          }\r\n\r\n          await gameHelpers.gamePopup(GameType.RANKED, opponent.name, name);\r\n\r\n          return;\r\n        }\r\n      }\r\n\r\n      const inserted = await $rankedQueuePlayers.insertOne({name, elo});\r\n\r\n      if (!inserted.insertedId) {\r\n        return error(\"Failed to insert player in the queue.\");\r\n      }\r\n    }\r\n\r\n    const $playerUpdate = await $players.updateOne({socketId}, {\r\n      $set: {\r\n        status: PlayerStatus.IN_QUEUE,\r\n        queueId\r\n      }\r\n    })\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Error updating player.\");\r\n    }\r\n\r\n    socket.emit(\"joinQueue\", {queueId});\r\n  });\r\n};\r\n\r\nexport {joinQueue};\r\n","import {PlayerStatus} from \"@som/shared/enums\";\r\nimport {mongo, server} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst leaveLobby: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$lobbies, $players} = mongo;\r\n\r\n  socket.on(\"leaveLobby\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found.\");\r\n    }\r\n    if (!$player.lobbyId) {\r\n      return error(\"You are not in a lobby.\");\r\n    }\r\n\r\n    const id = $player.lobbyId;\r\n    const $lobby = await $lobbies.findOne({id});\r\n\r\n    if (!$lobby) {\r\n      return error(\"Lobby not found.\");\r\n    }\r\n    if ($lobby.host.name === $player.name) {\r\n      return error(\"Lobby host can't leave lobby.\");\r\n    }\r\n\r\n    const [$lobbyUpdate, $playerUpdate, $playerHost] = await Promise.all([\r\n      $lobbies.updateOne({id}, {\r\n        $set: {\r\n          challengee: {\r\n            name: \"\",\r\n            avatarId: 0\r\n          }\r\n        }\r\n      }),\r\n      $players.updateOne({socketId}, {\r\n        $set: {\r\n          lobbyId: 0,\r\n          status: PlayerStatus.ONLINE\r\n        }\r\n      }),\r\n      $players.findOne({\r\n        name: $lobby.host.name\r\n      })\r\n    ]);\r\n\r\n    if (!$lobbyUpdate.modifiedCount) {\r\n      return error(\"Error updating lobby.\");\r\n    }\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Error updating player.\");\r\n    }\r\n\r\n    if (!$playerHost) {\r\n      return error(\"Lobby host not found.\");\r\n    }\r\n\r\n    socket.emit(\"leaveLobbySender\");\r\n    server.io.to($playerHost.socketId).emit(\"leaveLobbyReceiver\");\r\n  });\r\n};\r\n\r\nexport {leaveLobby};\r\n","import {PlayerStatus, QueueId} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst leaveQueue: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$casualQueuePlayers, $players, $rankedQueuePlayers} = mongo;\r\n\r\n  socket.on(\"leaveQueue\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found.\");\r\n    }\r\n    if (!$player.queueId) {\r\n      return error(\"You are not in a queue.\");\r\n    }\r\n\r\n    const {name} = $player;\r\n\r\n    if ($player.queueId === QueueId.CASUAL) {\r\n      const [deleteCasualQueuePlayer, updatePlayer] = await Promise.all([\r\n        $casualQueuePlayers.deleteOne({name}),\r\n        $players.updateOne({name}, {\r\n          $set: {\r\n            status: PlayerStatus.ONLINE,\r\n            queueId: 0\r\n          }\r\n        })\r\n      ]);\r\n\r\n      if (!deleteCasualQueuePlayer.deletedCount || !updatePlayer.modifiedCount) {\r\n        return error(\"Error removing player from queue.\");\r\n      }\r\n    } else if ($player.queueId === QueueId.RANKED) {\r\n      const [deleteRankedQueuePlayer, updatePlayer] = await Promise.all([\r\n        $rankedQueuePlayers.deleteOne({name}),\r\n        $players.updateOne({name}, {\r\n          $set: {\r\n            status: PlayerStatus.ONLINE,\r\n            queueId: 0\r\n          }\r\n        })\r\n      ]);\r\n\r\n      if (!deleteRankedQueuePlayer.deletedCount || !updatePlayer.modifiedCount) {\r\n        return error(\"Error removing player from queue.\");\r\n      }\r\n    }\r\n\r\n    socket.emit(\"leaveQueue\");\r\n  });\r\n};\r\n\r\nexport {leaveQueue};\r\n","import {cards} from \"@som/shared/data\";\r\nimport {CardType} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst saveDeck: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$players} = mongo;\r\n\r\n  socket.on(\"saveDeck\", async (params) => {\r\n    const {deck} = params;\r\n\r\n    if (deck.name.length >= 12) {\r\n      return error(\"Maximum 12 characters length allowed for deck name.\");\r\n    }\r\n    if (deck.klass < 1 || deck.klass > 4) { // prevent decimals?\r\n      return error(\"Invalid class.\");\r\n    }\r\n\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    for (const deckCard of deck.cards) {\r\n      const card = cards.find((card) => card.id === deckCard.id);\r\n\r\n      if (!card) {\r\n        return error(\"One of the cards in your deck is invalid.\");\r\n      }\r\n\r\n      if (card.type === CardType.HERO) {\r\n        return error(\"Can't add Hero as a deck card.\");\r\n      }\r\n\r\n      if (deckCard.amount > 2 || deckCard.amount < 1) { // prevent decimals?\r\n        return error(\"Invalid amount of same cards added.\");\r\n      }\r\n    }\r\n\r\n    const totalCards = deck.cards.reduce((acc, {amount}) => acc += amount, 0);\r\n\r\n    if (totalCards !== 30) {\r\n      return error(\"Invalid number of cards, should be 30.\");\r\n    }\r\n\r\n    const $playerUpdate = await $players.updateOne({\r\n      socketId,\r\n      \"decks.id\": $player.deckId\r\n    }, {\r\n      $set: {\r\n        \"decks.$\": deck\r\n      }\r\n    });\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Error saving deck (Most likely you made no changes to it).\");\r\n    }\r\n\r\n    socket.emit(\"notification\", \"Deck saved successfully.\");\r\n  });\r\n};\r\n\r\nexport {saveDeck};\r\n","import {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst selectDeck: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$players} = mongo;\r\n\r\n  socket.on(\"selectDeck\", async (params) => {\r\n    const {deckId} = params;\r\n\r\n    if (deckId < 0 || deckId > 3) {\r\n      return error(\"Invalid deck range.\");\r\n    }\r\n\r\n    const $playerUpdate = await $players.updateOne({socketId}, {\r\n      $set: {deckId}\r\n    });\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Failed to set deck id.\");\r\n    }\r\n\r\n    socket.emit(\"selectDeck\", {deckId});\r\n  });\r\n};\r\n\r\nexport {selectDeck};\r\n","import {items} from \"@som/shared/data\";\r\nimport {contracts, mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst selectSkin: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"selectSkin\", async (params) => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found.\");\r\n    }\r\n\r\n    const {name} = $player;\r\n    const $account = await $accounts.findOne({name});\r\n\r\n    if (!$account) {\r\n      return error(\"Account not found.\");\r\n    }\r\n\r\n    const {id} = params;\r\n    const item = items.find((item) => item.id === id);\r\n\r\n    if (!item || item.type !== 2) { // 2 === skin, make ItemType enum?\r\n      return error(\"Selected item isn't a skin.\");\r\n    }\r\n\r\n    const balance = await contracts.skins.balanceOf($account.publicKey, id);\r\n\r\n    if (balance.lte(0)) {\r\n      return error(\"You do not own the skin.\");\r\n    }\r\n\r\n    const $playerUpdate = await $players.updateOne({\r\n      socketId,\r\n      \"skins.cardId\": item.cardId\r\n    }, {\r\n      $set: {\r\n        \"skins.$\": {cardId: item.cardId, skinId: id}\r\n      }\r\n    });\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      // most likely failed because skins.$ object not found, in that case add\r\n      // it instead.\r\n      const $playerUpdate2 = await $players.updateOne({socketId}, {\r\n        $addToSet: {\r\n          skins: {cardId: item.cardId, skinId: id}\r\n        }\r\n      });\r\n\r\n      if (!$playerUpdate2) {\r\n        return error(\"Failed to set the skin.\");\r\n      }\r\n    }\r\n\r\n    socket.emit(\"selectSkin\", {\r\n      cardId: item.cardId,\r\n      skinId: id\r\n    });\r\n  });\r\n};\r\n\r\nexport {selectSkin};\r\n","import {GameType} from \"@som/shared/enums\";\r\nimport {mongo} from \"app\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst startCustomGame: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$lobbies, $players} = mongo;\r\n\r\n  socket.on(\"startCustomGame\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, please relog.\");\r\n    }\r\n    if (!$player.lobbyId) {\r\n      return error(\"You are not in a lobby.\");\r\n    }\r\n\r\n    const id = $player.lobbyId;\r\n    const $lobby = await $lobbies.findOne({id});\r\n\r\n    if (!$lobby) {\r\n      return error(\"Lobby not found.\");\r\n    }\r\n    if ($player.name !== $lobby.host.name) {\r\n      return error(\"You are not the host.\");\r\n    }\r\n\r\n    const $lobbyDelete = await $lobbies.deleteOne({id});\r\n\r\n    if (!$lobbyDelete.deletedCount) {\r\n      return error(\"Failed to delete lobby.\");\r\n    }\r\n\r\n    const {host, challengee} = $lobby;\r\n\r\n    await gameHelpers.startGame(\r\n      $lobby.id,\r\n      GameType.CUSTOM,\r\n      host.name,\r\n      challengee.name\r\n    );\r\n  });\r\n};\r\n\r\nexport {startCustomGame};\r\n","import {acceptGame} from \"./acceptGame\";\r\nimport {closeLobby} from \"./closeLobby\";\r\nimport {createLobby} from \"./createLobby\";\r\nimport {declineGame} from \"./declineGame\";\r\nimport {defaultSkin} from \"./defaultSkin\";\r\nimport {finishTutorial} from \"./finishTutorial\";\r\nimport {getLeaderboards} from \"./getLeaderboards\";\r\nimport {joinLobby} from \"./joinLobby\";\r\nimport {joinQueue} from \"./joinQueue\";\r\nimport {leaveLobby} from \"./leaveLobby\";\r\nimport {leaveQueue} from \"./leaveQueue\";\r\nimport {saveDeck} from \"./saveDeck\";\r\nimport {selectDeck} from \"./selectDeck\";\r\nimport {selectSkin} from \"./selectSkin\";\r\nimport {startCustomGame} from \"./startCustomGame\";\r\n\r\nconst client = [\r\n  acceptGame,\r\n  closeLobby,\r\n  createLobby,\r\n  declineGame,\r\n  defaultSkin,\r\n  finishTutorial,\r\n  getLeaderboards,\r\n  joinLobby,\r\n  joinQueue,\r\n  leaveLobby,\r\n  leaveQueue,\r\n  saveDeck,\r\n  selectDeck,\r\n  selectSkin,\r\n  startCustomGame\r\n];\r\n\r\nexport {client};\r\n","import {EffectId} from \"@som/shared/enums\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst attackHero: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {effect} = gameHelpers;\r\n\r\n  socket.on(\"attackHero\", async (params) => {\r\n    const [getGameData, getGameError] = await gameHelpers.getGame(socketId);\r\n\r\n    if (!getGameData) {\r\n      return error(getGameError);\r\n    }\r\n\r\n    const {attacker} = params;\r\n    const {$game, player, opponent} = getGameData;\r\n    const playerMinion = player.minion[attacker];\r\n    const opponentHero = opponent.hero;\r\n    const animations: any[] = [];\r\n\r\n    if (!playerMinion) {\r\n      return;\r\n    }\r\n\r\n    const multiStrikeBuff = playerMinion.buffs.find((buff) => buff.id === EffectId.BLAZE);\r\n\r\n    if (!playerMinion.canAttack) {\r\n      if (multiStrikeBuff && !multiStrikeBuff.data.hasAtacked) {\r\n        multiStrikeBuff.data.hasAttacked = true;\r\n      } else {\r\n        return error(\"This card can't attack anymore this turn.\");\r\n      }\r\n    } else {\r\n      playerMinion.canAttack = false;\r\n    }\r\n\r\n    const {trap} = opponent;\r\n\r\n    if (trap && trap.effect === EffectId.MIRRORS_EDGE) {\r\n      animations.push(...effect.mirrorsEdge({\r\n        player,\r\n        playerMinion,\r\n        opponent,\r\n        opponentTrap: trap\r\n      }));\r\n\r\n      if (await gameHelpers.isGameOver($game)) { return; }\r\n    }\r\n\r\n    if (opponent.trap && opponent.trap.effect === EffectId.RICOCHET) {\r\n      animations.push(...effect.ricochet({\r\n        player,\r\n        playerMinion,\r\n        opponent,\r\n        opponentTrap: opponent.trap\r\n      }));\r\n    }\r\n\r\n    if (trap && trap.effect === EffectId.RETRIBUTION) {\r\n      gameHelpers.effect.retribution({player, field: attacker});\r\n    }\r\n\r\n    if (trap && trap.effect === EffectId.FROSTBITE) {\r\n      animations.push(...effect.frostbite({\r\n        player,\r\n        playerMinion,\r\n        playerMinionField: attacker,\r\n        opponent,\r\n        opponentTrap: trap\r\n      }));\r\n    }\r\n\r\n    if (trap && trap.effect === EffectId.RUSTY_NEEDLE) {\r\n      gameHelpers.insertDebuff(playerMinion, EffectId.NEUROTOXIN);\r\n    }\r\n\r\n    if (trap && trap.effect === EffectId.NOXIOUS_FUMES) {\r\n      const field = attacker;\r\n      effect.noxiousFumes({opponent: player, minion: playerMinion, field});\r\n    }\r\n\r\n    if (trap && trap.effect === EffectId.EXPLOSIVE) {\r\n      const field = attacker;\r\n      effect.explosive({player, opponent, trap, field});\r\n    }\r\n\r\n    if (playerMinion.health && playerMinion.buffs.find((buff) => buff.id === EffectId.CORROSIVE_TOUCH)) {\r\n      gameHelpers.effect.corrosiveTouch({opponent});\r\n    }\r\n\r\n    if (playerMinion.health && playerMinion.buffs.find((buff) => buff.id === EffectId.RAMPAGE)) {\r\n      effect.rampage({minion: playerMinion});\r\n    }\r\n\r\n    if (playerMinion.health && playerMinion.buffs.find((buff) => buff.id === EffectId.BACKSTAB)) {\r\n      effect.backstab({opponent, minion: playerMinion}); // only trigger, handle animation here\r\n    }\r\n\r\n    opponentHero.health -= playerMinion.damage;\r\n\r\n    if (await gameHelpers.isGameOver($game)) {\r\n      return;\r\n    }\r\n\r\n    await gameHelpers.saveGame($game);\r\n  });\r\n};\r\n\r\nexport {attackHero};\r\n","import {CardKlass, EffectId} from \"@som/shared/enums\";\r\nimport {Animations} from \"@som/shared/types/game\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\nimport { Field } from \"@som/shared/types/mongo\";\r\n\r\nconst attackMinion: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {effect} = gameHelpers;\r\n\r\n  socket.on(\"attackMinion\", async (params) => {\r\n    const [getGameData, getGameError] = await gameHelpers.getGame(socketId);\r\n\r\n    if (!getGameData) {\r\n      return error(getGameError);\r\n    }\r\n\r\n    const {attacked, attacker} = params;\r\n\r\n    if (attacked === \"hero\" || attacker === \"hero\") {\r\n      return error(\"Cannot attack hero.\");\r\n    }\r\n\r\n    const {$game, player, opponent} = getGameData;\r\n    const playerMinion = player.field[attacker];\r\n    const opponentMinion = opponent.field[attacked];\r\n    const opponentTrap = opponent.trap;\r\n    let animations: Animations = [];\r\n\r\n    if (!playerMinion) {\r\n      return error(\"Players minion not found.\");\r\n    }\r\n\r\n    if (!opponentMinion) {\r\n      return error(\"Opponents minion not found.\");\r\n    }\r\n\r\n    const fields: [\"hero\", \"a\", \"b\", \"c\", \"d\"] = [\"hero\", \"a\", \"b\", \"c\", \"d\"];\r\n    const selected = fields.find((field) => field === attacked);\r\n\r\n    if (!selected) {\r\n      return error(\"Error\");\r\n    }\r\n\r\n    fields.splice(fields.indexOf(selected), 1);\r\n\r\n    for (const field of fields) {\r\n      const fieldCard = opponent.field[field];\r\n\r\n      if (fieldCard) {\r\n        const taunt = fieldCard.buffs.find((buff) => buff.id === EffectId.TAUNT);\r\n        const marksmanship = playerMinion.buffs.find((buff) => buff.id === EffectId.MARKSMANSHIP);\r\n\r\n        if (taunt && !marksmanship) {\r\n          return error(\"Cannot attack this minion, other has taunt.\");\r\n        }\r\n      }\r\n    }\r\n\r\n    if (\r\n      opponentMinion.buffs.find((buff) => buff.id === EffectId.STEALTH) &&\r\n      !playerMinion.buffs.find((buff) => buff.id === EffectId.SHADOWSTRIKE)\r\n    ) {\r\n      return error(\"Can't attack minion with stealth.\");\r\n    }\r\n\r\n    const multiStrikeBuff = playerMinion.buffs.find((buff) => buff.id === EffectId.BLAZE);\r\n\r\n    if (!playerMinion.canAttack) {\r\n      if (multiStrikeBuff && !multiStrikeBuff.data.hasAtacked) {\r\n        multiStrikeBuff.data.hasAttacked = true;\r\n      } else {\r\n        return error(\"This card can't attack anymore this turn.\");\r\n      }\r\n    } else {\r\n      playerMinion.canAttack = false;\r\n    }\r\n\r\n\r\n    let isAttackNegated = false;\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.MIRRORS_EDGE) {\r\n      animations.push(\r\n        ...effect.mirrorsEdge({player, playerMinion, opponent, opponentTrap})\r\n      );\r\n\r\n      if (await gameHelpers.isGameOver($game)) { return; }\r\n\r\n      isAttackNegated = true;\r\n    }\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.RICOCHET) {\r\n      animations.push(\r\n        ...effect.ricochet({player, playerMinion, opponent, opponentTrap})\r\n      );\r\n\r\n      isAttackNegated = true;\r\n    }\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.FROSTBITE) {\r\n      animations.push(...effect.frostbite({\r\n        player,\r\n        playerMinion,\r\n        playerMinionField: attacker,\r\n        opponent,\r\n        opponentTrap\r\n      }));\r\n    }\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.RUSTY_NEEDLE) {\r\n      gameHelpers.insertDebuff(playerMinion, EffectId.NEUROTOXIN);\r\n    }\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.NOXIOUS_FUMES) {\r\n      animations.push(...effect.noxiousFumes({\r\n        player,\r\n        playerMinion,\r\n        playerMinionField: attacker,\r\n        opponent,\r\n        opponentTrap\r\n      }));\r\n    }\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.EXPLOSIVE) {\r\n      animations.push(...effect.explosive({\r\n        player,\r\n        playerMinionField: attacker,\r\n        opponent,\r\n        opponentTrap\r\n      }));\r\n    }\r\n\r\n    if (opponentTrap && opponentTrap.effect === EffectId.CONSTRICTION) {\r\n      animations.push(\r\n        ...effect.constriction({player, playerMinion, opponent, opponentTrap})\r\n      );\r\n    }\r\n\r\n\r\n    if (playerMinion.buffs.find((buff) => buff.id === EffectId.POISONOUS_TOUCH)) {\r\n      gameHelpers.insertDebuff(opponentMinion, EffectId.NEUROTOXIN);\r\n    }\r\n    if (playerMinion.buffs.find((buff) => buff.id === EffectId.CORROSIVE_TOUCH)) {\r\n      gameHelpers.effect.corrosiveTouch({opponent});\r\n      if (await gameHelpers.isGameOver($game)) {\r\n        return;\r\n      }\r\n    }\r\n    if (playerMinion.buffs.find((buff) => buff.id === EffectId.OVERPOWER)) {\r\n      if (playerMinion.damage > opponentMinion.health) {\r\n        gameHelpers.effect.overpower({opponent, damage: playerMinion.damage - opponentMinion.health});\r\n        if (await gameHelpers.isGameOver($game)) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (opponentMinion.buffs.find((buff) => buff.id === EffectId.POISONOUS_TOUCH)) {\r\n      gameHelpers.insertDebuff(playerMinion, EffectId.NEUROTOXIN);\r\n    }\r\n    if (opponentMinion.buffs.find((buff) => buff.id === EffectId.CORROSIVE_TOUCH)) {\r\n      gameHelpers.effect.corrosiveTouch({opponent: player});\r\n      if (await gameHelpers.isGameOver($game)) {\r\n        return;\r\n      }\r\n    }\r\n    if (opponentMinion.buffs.find((buff) => buff.id === EffectId.OVERPOWER)) {\r\n      if (opponentMinion.damage > playerMinion.health) {\r\n        gameHelpers.effect.overpower({opponent, damage: opponentMinion.damage - playerMinion.health});\r\n        if (await gameHelpers.isGameOver($game)) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    if (!isAttackNegated) {\r\n      gameHelpers.deductHealth(player, playerMinion, opponentMinion.damage);\r\n      animations.push({\r\n        type: \"DAMAGE\",\r\n        field: attacker,\r\n        damageTaken: opponentMinion.damage,\r\n        name: player.name\r\n      });\r\n\r\n      gameHelpers.deductHealth(opponent, opponentMinion, playerMinion.damage);\r\n      animations.push({\r\n        type: \"DAMAGE\",\r\n        field: attacked,\r\n        damageTaken: playerMinion.damage,\r\n        name: opponent.name\r\n      });\r\n    }\r\n\r\n    if (playerMinion.health <= 0 || (playerMinion.health === 1 && opponentMinion.buffs.find((buff) => buff.id === EffectId.EXECUTE))) {\r\n      if (player.trap && player.trap.effect === EffectId.LAST_STAND) {\r\n        gameHelpers.effect.lastStand({minion: playerMinion, opponent: player, trap: player.trap})\r\n      } else {\r\n        const hasAcidicDeathBuff = playerMinion.buffs.find((buff) => buff.id === EffectId.ACIDIC_DEATH);\r\n        const hasSelfDescturctDebuff = playerMinion.debuffs.find((debuff) => debuff.id === EffectId.SELF_DESTRUCT);\r\n        if (player.trap && player.trap.effect === EffectId.REFLECTION) {\r\n          gameHelpers.effect.reflection({player, opponent, trap: player.trap});\r\n        }\r\n\r\n        gameHelpers.moveToGraveyard(player, playerMinion, attacker);\r\n        animations.push({\r\n          type: \"DEATH\",\r\n          field: attacker,\r\n          name: player.name\r\n        });\r\n        if (hasSelfDescturctDebuff) {\r\n          gameHelpers.effect.selfDestruct({player});\r\n          if (await gameHelpers.isGameOver($game)) {\r\n            return;\r\n          }\r\n        }\r\n\r\n        if (hasAcidicDeathBuff) {\r\n          effect.acidicDeath({player, opponent});\r\n        }\r\n\r\n        (Object.keys(player.minion) as Array<keyof typeof player.minion>).forEach((key) => {\r\n          const minion = player.minion[key];\r\n          if (!minion) { return; }\r\n          if (minion.buffs.find((buff) => buff.id === EffectId.RISING_FURY)) {\r\n            gameHelpers.effect.risingFury({minionCard: minion});\r\n          }\r\n          if (minion.buffs.find((buff) => buff.id === EffectId.SACRIFICE)) {\r\n            if (playerMinion.klass === CardKlass.LIQUID) {\r\n              const minion = gameHelpers.getRandomMinion(player);\r\n              if (!minion) {return; }\r\n              minion.health += 3;\r\n            }\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      if (playerMinion.buffs.find((buff) => buff.id === EffectId.RAMPAGE)) {\r\n        effect.rampage({minion: playerMinion});\r\n      }\r\n    }\r\n\r\n    if (opponentMinion.health <= 0 || (opponentMinion.health === 1 && playerMinion.buffs.find((buff) => buff.id === EffectId.EXECUTE))) {\r\n      if (opponent.trap && opponent.trap.effect === EffectId.LAST_STAND) {\r\n        gameHelpers.effect.lastStand({minion: opponentMinion, opponent, trap: opponent.trap})\r\n      } else {\r\n        const hasAcidicDeathBuff = playerMinion.buffs.find((buff) => buff.id === EffectId.ACIDIC_DEATH);\r\n        const hasSelfDescturctDebuff = playerMinion.debuffs.find((debuff) => debuff.id === EffectId.SELF_DESTRUCT);\r\n        if (opponent.trap && opponent.trap.effect === EffectId.REFLECTION) {\r\n          gameHelpers.effect.reflection({player: opponent, opponent: player, trap: opponent.trap});\r\n        }\r\n        gameHelpers.moveToGraveyard(opponent, opponentMinion, attacked);\r\n        animations.push({\r\n          type: \"DEATH\",\r\n          field: attacked,\r\n          name: opponent.name\r\n        });\r\n        if (hasSelfDescturctDebuff) {\r\n          gameHelpers.effect.selfDestruct({player});\r\n          if (await gameHelpers.isGameOver($game)) {\r\n            return;\r\n          }\r\n        }\r\n\r\n        if (hasAcidicDeathBuff) {\r\n          effect.acidicDeath({player, opponent});\r\n        }\r\n      }\r\n\r\n      (Object.keys(opponent.minion) as Array<keyof typeof opponent.minion>).forEach((key) => {\r\n        const minion = opponent.minion[key];\r\n        if (!minion) { return; }\r\n        if (minion.buffs.find((buff) => buff.id === EffectId.RISING_FURY)) {\r\n          gameHelpers.effect.risingFury({minionCard: minion});\r\n        }\r\n        if (minion.buffs.find((buff) => buff.id === EffectId.SACRIFICE)) {\r\n          if (opponentMinion.klass === CardKlass.LIQUID) {\r\n            const minion = gameHelpers.getRandomMinion(opponent);\r\n            if (!minion) {return; }\r\n            minion.health += 3;\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      if (opponentMinion.buffs.find((buff) => buff.id === EffectId.RAMPAGE)) {\r\n        effect.rampage({minion: opponentMinion});\r\n      }\r\n    }\r\n\r\n    // $game.battleLogs.push(attacked, attacker, playerMinion.id, opponentMinion.id);\r\n\r\n    await gameHelpers.attackMinionSave($game, animations);\r\n  });\r\n};\r\n\r\nexport {attackMinion};\r\n","import {CardType, EffectId} from \"@som/shared/enums\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst endTurn: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n\r\n  socket.on(\"endTurn\", async () => {\r\n    const [getGameData, getGameError] = await gameHelpers.getGame(socketId);\r\n\r\n    if (!getGameData) {\r\n      return error(getGameError);\r\n    }\r\n\r\n    const {$game, player, opponent} = getGameData;\r\n\r\n    await gameHelpers.drawCard($game, player, opponent);\r\n\r\n    player.field.hero.mana = 10;\r\n\r\n    const playerMinionFields = Object.keys(player.field) as Array<keyof typeof player.field>;\r\n\r\n    playerMinionFields.forEach((field) => {\r\n      const minion = player.field[field];\r\n\r\n      if (!minion || minion.type === CardType.HERO) { return; }\r\n\r\n      minion.canAttack = true;\r\n      gameHelpers.effect.blaze({minion});\r\n\r\n      if (minion.buffs.find((buff) => buff.id === EffectId.REGENERATION)) {\r\n        gameHelpers.effect.regeneration({player});\r\n      }\r\n    });\r\n\r\n    $game.currentPlayer = opponent.name;\r\n    $game.currentTurn += 1;\r\n\r\n    await gameHelpers.saveGame($game);\r\n  });\r\n};\r\n\r\nexport {endTurn};\r\n","import {CardType, EffectId, LogType} from \"@som/shared/enums\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst playMagic: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {effect} = gameHelpers;\r\n\r\n  socket.on(\"playMagic\", async (params) => {\r\n    const [getGameData, getGameError] = await gameHelpers.getGame(socketId);\r\n\r\n    if (!getGameData) {\r\n      return error(getGameError);\r\n    }\r\n\r\n    const {gid, field, target} = params;\r\n    const {$game, player, opponent} = getGameData;\r\n\r\n    if (field && opponent.field[field]?.buffs.find((buff) => buff.id === EffectId.ELUSIVE)) {\r\n      return error(\"Selected card has Elusive buff.\");\r\n    }\r\n\r\n    const card = player.hand.find((card) => card.gid === gid);\r\n\r\n    if (!card) {\r\n      return error(\"Card not found in hand.\");\r\n    }\r\n\r\n    if (card.type !== CardType.MAGIC) {\r\n      return error(\"Selected card is not Magic.\");\r\n    }\r\n\r\n    if (card.manaCost > player.field.hero.mana) {\r\n      return error(\"Not enough mana.\");\r\n    }\r\n\r\n    player.field.hero.mana -= card.manaCost;\r\n    player.hand.splice(player.hand.indexOf(card), 1);\r\n    player.graveyard.push(card);\r\n\r\n    let logText = \"\";\r\n\r\n    const {trap} = opponent;\r\n\r\n    if (trap && trap.effect === EffectId.SILENCE) {\r\n      effect.silence({opponent, trap});\r\n    } else {\r\n      if (card.effect === EffectId.REBIRTH) {\r\n        const [success, message] = effect.rebirth({player, target, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.DIMINISH) {\r\n        const [success, message] = effect.diminish({opponent, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.RELOAD) {\r\n        effect.reload({player});\r\n      }\r\n\r\n      if (card.effect === EffectId.VALOR) {\r\n        const [success, message] = effect.valor({opponent});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          if (await gameHelpers.isGameOver($game)) { return; }\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.SHELL) {\r\n        const [success, message] = effect.shell({player});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.FORTITUDE) {\r\n        const [success, message] = effect.fortitude({player, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.ELECTRO_SHOCK) {\r\n        const [success, message] = effect.electroShock({player, opponent});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.CLEANSE) {\r\n        const [success, message] = effect.cleanse({player, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.TIDAL_WAVE) {\r\n        const [success, message] = effect.tidalWave({player});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.ACID_RAIN) {\r\n        const [success, message] = effect.acidRain({opponent});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.SMOKE_BOMB) {\r\n        const [success, message] = effect.smokeBomb({player});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.CONTAMINATED_AIR) {\r\n        const [success, message] = effect.contaminatedAir({player, opponent});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.IGNITE) {\r\n        const [success, message] = effect.ignite({player, opponent, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.CORRUPTION) {\r\n        const [success, message] = effect.corruption({player, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n\r\n      if (card.effect === EffectId.HYSTERIA) {\r\n        const [success, message] = effect.hysteria({player, field});\r\n        if (!success) {\r\n          return error(message);\r\n        } else {\r\n          logText = message;\r\n        }\r\n      }\r\n    }\r\n\r\n    $game.gameLogs.push({\r\n      type: LogType.MAGIC,\r\n      player: player.name,\r\n      magicId: card.id\r\n    });\r\n\r\n    await gameHelpers.saveGame($game);\r\n  });\r\n};\r\n\r\nexport {playMagic};\r\n","import {CardType, EffectId, LogType} from \"@som/shared/enums\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst playMinion: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {effect} = gameHelpers;\r\n\r\n  socket.on(\"playMinion\", async (params) => {\r\n    const [getGameData, getGameError] = await gameHelpers.getGame(socketId);\r\n\r\n    if (!getGameData) {\r\n      return error(getGameError);\r\n    }\r\n\r\n    const {$game, player, opponent} = getGameData;\r\n    const {field, gid} = params;\r\n\r\n    if (player.field[field]) {\r\n      return error(\"Field already inhibits a Minion.\");\r\n    }\r\n\r\n    const card = player.hand.find((card) => card.gid === gid);\r\n\r\n    if (!card) {\r\n      return error(\"Card not found in hand.\");\r\n    }\r\n\r\n    if (card.type !== CardType.MINION) {\r\n      return error(\"Selected card is not Minion.\");\r\n    }\r\n\r\n    if (card.manaCost > player.hero.mana) {\r\n      return error(\"Not enough mana.\");\r\n    }\r\n\r\n    player.field.hero.mana -= card.manaCost;\r\n    player.field[field] = card;\r\n\r\n    const minion = player.field[field];\r\n\r\n    if (!minion) {\r\n      return error(\"Error summoning card.\");\r\n    }\r\n\r\n    player.hand.splice(player.hand.indexOf(card), 1);\r\n\r\n    const {trap} = opponent;\r\n    const isElusive = minion.effect === EffectId.ELUSIVE;\r\n\r\n    // Step 1: Insert buffs / debuffs\r\n    // Step 2: Check for on summon trap cards\r\n    // Step 3: Trigger on summon effects\r\n\r\n    // [1] INSERT BUFFS / DEBUFFS\r\n    switch (minion.effect) {\r\n      // Neutral\r\n      case EffectId.BLAZE:\r\n        const hasAttackedTwice = true;\r\n        gameHelpers.insertBuff(minion, EffectId.BLAZE, {hasAttackedTwice});\r\n        break;\r\n      case EffectId.ELUSIVE:\r\n        gameHelpers.insertBuff(minion, EffectId.ELUSIVE);\r\n        break;\r\n      case EffectId.REVENGE:\r\n        gameHelpers.insertBuff(minion, EffectId.REVENGE);\r\n        break;\r\n      // Solid\r\n      case EffectId.UNITY:\r\n        gameHelpers.insertBuff(minion, EffectId.UNITY);\r\n        break;\r\n      case EffectId.UNBREAKABLE:\r\n        gameHelpers.insertBuff(minion, EffectId.UNBREAKABLE);\r\n        break;\r\n      case EffectId.PROTECTOR:\r\n        gameHelpers.insertBuff(minion, EffectId.TAUNT);\r\n        break;\r\n      // ---------- [ L I Q U I D ] ----------\r\n      case EffectId.RISING_FURY:\r\n        gameHelpers.insertBuff(minion, EffectId.RISING_FURY);\r\n        break;\r\n      case EffectId.REGENERATION:\r\n        gameHelpers.insertBuff(minion, EffectId.REGENERATION);\r\n        break;\r\n      case EffectId.SACRIFICE:\r\n        gameHelpers.insertBuff(minion, EffectId.SACRIFICE);\r\n        break;\r\n      case EffectId.SHADOWSTRIKE:\r\n        gameHelpers.insertBuff(minion, EffectId.SHADOWSTRIKE);\r\n        break;\r\n      case EffectId.LEECH:\r\n        gameHelpers.insertBuff(minion, EffectId.LEECH);\r\n        break;\r\n      case EffectId.RESILIENT:\r\n        gameHelpers.insertBuff(minion, EffectId.RESILIENT);\r\n        break;\r\n      // Gas\r\n      case EffectId.ACIDIC_DEATH:\r\n        gameHelpers.insertBuff(minion, EffectId.ACIDIC_DEATH);\r\n        break;\r\n      case EffectId.STEALTH:\r\n        gameHelpers.insertBuff(minion, EffectId.STEALTH);\r\n        break;\r\n      case EffectId.POISONOUS_TOUCH:\r\n        gameHelpers.insertBuff(minion, EffectId.POISONOUS_TOUCH);\r\n        break;\r\n      case EffectId.CORROSIVE_TOUCH:\r\n        gameHelpers.insertBuff(minion, EffectId.CORROSIVE_TOUCH);\r\n        break;\r\n      // ---------- [ P L A S M A ] ----------\r\n      case EffectId.SELF_DESTRUCT:\r\n        gameHelpers.insertBuff(minion, EffectId.SELF_DESTRUCT);\r\n        break;\r\n      case EffectId.RAMPAGE:\r\n        gameHelpers.insertBuff(minion, EffectId.RAMPAGE);\r\n        break;\r\n      case EffectId.BACKSTAB:\r\n        gameHelpers.insertBuff(minion, EffectId.BACKSTAB);\r\n        break;\r\n      case EffectId.MARKSMANSHIP:\r\n        gameHelpers.insertBuff(minion, EffectId.MARKSMANSHIP);\r\n        break;\r\n      case EffectId.OVERPOWER:\r\n        gameHelpers.insertBuff(minion, EffectId.OVERPOWER);\r\n        break;\r\n      case EffectId.EXECUTE:\r\n        gameHelpers.insertBuff(minion, EffectId.EXECUTE);\r\n        break;\r\n    }\r\n\r\n    // [2] ON SUMMON TRAP TRIGGERS\r\n    if (trap && !isElusive) {\r\n      switch (trap.effect) {\r\n        case EffectId.SMITE:\r\n          effect.smite({player, opponent, minion, trap, field});\r\n          break;\r\n        case EffectId.BANISH:\r\n          effect.banish({player, opponent, minion, trap, field});\r\n          break;\r\n        case EffectId.POISONED_GROUND:\r\n          effect.poisonedGround({player: opponent, minion, trap});\r\n          break;\r\n      }\r\n    } else {\r\n      // [3] TRIGGER ON SUMMON EFFECTS\r\n      switch (minion.effect) {\r\n        // ---------- [ N E U T R A L ] ----------\r\n        case EffectId.SHADOW_SURGE:\r\n          effect.shadowSurge({minion});\r\n          break;\r\n        case EffectId.QUICK_SHOT:\r\n          effect.quickShot({opponent});\r\n          break;\r\n        case EffectId.NECROMANCY:\r\n          effect.necromancy({minion, isPositive: false});\r\n          break;\r\n        // ---------- [ S O L I D ] ----------\r\n        case EffectId.GLORY:\r\n          effect.glory({opponent, minion});\r\n          break;\r\n        case EffectId.SPELLWEAVE:\r\n          effect.spellweave({player, minion});\r\n          break;\r\n        case EffectId.SHIELDWALL:\r\n          effect.shieldwall({player, field});\r\n          break;\r\n        // ---------- [ G A S ] ----------\r\n        case EffectId.TOXIC_SPRAY:\r\n          effect.toxicSpray({opponent});\r\n          break;\r\n        case EffectId.TOXIC_GAS:\r\n          effect.toxicGas({opponent});\r\n          break;\r\n        default:\r\n          return error(\"Effect not found.\");\r\n      }\r\n    }\r\n\r\n    $game.gameLogs.push({\r\n      type: LogType.SUMMON,\r\n      field,\r\n      player: player.name,\r\n      minionId: minion.id\r\n    });\r\n\r\n    await gameHelpers.saveGame($game);\r\n  });\r\n};\r\n\r\nexport {playMinion};\r\n","import {CardType} from \"@som/shared/enums\";\r\nimport {gameHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst playTrap: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n\r\n  socket.on(\"playTrap\", async (params) => {\r\n    const [getGameData, getGameError] = await gameHelpers.getGame(socketId);\r\n\r\n    if (!getGameData) {\r\n      return error(getGameError);\r\n    }\r\n\r\n    const {$game, player} = getGameData;\r\n    const {name, hand, trap} = player;\r\n    const {gid} = params;\r\n\r\n    if (trap) {\r\n      return error(\"Trap Card is already set.\");\r\n    }\r\n\r\n    const card = hand.find((card) => card.gid === gid);\r\n\r\n    if (!card) {\r\n      return error(\"Card not found in hand.\");\r\n    }\r\n\r\n    if (card.type !== CardType.TRAP) {\r\n      return error(\"Selected card is not Trap.\");\r\n    }\r\n\r\n    if (card.manaCost > player.field.hero.mana) {\r\n      return error(\"Not enough mana.\");\r\n    }\r\n\r\n    player.field.hero.mana -= card.manaCost;\r\n    hand.splice(hand.indexOf(card), 1);\r\n    player.trap = card;\r\n\r\n    socket.emit(\"playTrap\", {name});\r\n\r\n    await gameHelpers.saveGame($game);\r\n  });\r\n};\r\n\r\nexport {playTrap};\r\n","import {attackHero} from \"./attackHero\";\r\nimport {attackMinion} from \"./attackMinion\";\r\nimport {endTurn} from \"./endTurn\";\r\nimport {playMagic} from \"./playMagic\";\r\nimport {playMinion} from \"./playMinion\";\r\nimport {playTrap} from \"./playTrap\";\r\n\r\nconst game = [\r\n  attackHero,\r\n  attackMinion,\r\n  endTurn,\r\n  playMagic,\r\n  playMinion,\r\n  playTrap\r\n];\r\n\r\nexport {game};\r\n","import {mongo, server} from \"app\";\r\nimport type {UpdateFilter} from \"mongodb\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\nimport type {Account} from \"@som/shared/types/mongo\";\r\n\r\nconst acceptFriend: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $chats, $players} = mongo;\r\n\r\n  socket.on(\"acceptFriend\", async (params) => {\r\n    const {name} = params;\r\n\r\n    const [$playerSender, $playerReceiver] = await Promise.all([\r\n      $players.findOne({socketId}),\r\n      $players.findOne({name})\r\n    ]);\r\n\r\n    if (!$playerSender) {\r\n      return error(\"Player sender not found.\");\r\n    }\r\n\r\n    if (!$playerReceiver) {\r\n      return error(\"Player receiver not found.\");\r\n    }\r\n\r\n    const [$accountSender, $accountReceiver, $chatInsert] = await Promise.all([\r\n      $accounts.findOneAndUpdate({\r\n        name: $playerSender.name\r\n      }, {\r\n        $pull: {\r\n          \"social.requests\": name\r\n        },\r\n        $push: {\r\n          \"social.friends\": name\r\n        }\r\n      } as UpdateFilter<Account> | Partial<Account>, { // bug: https://github.com/Automattic/mongoose/issues/10075\r\n        returnDocument: \"after\"\r\n      }),\r\n\r\n      $accounts.findOneAndUpdate({name}, {\r\n        $push: {\r\n          \"social.friends\": $playerSender.name\r\n        }\r\n      } as UpdateFilter<Account> | Partial<Account>, { // bug: https://github.com/Automattic/mongoose/issues/10075\r\n        returnDocument: \"after\"\r\n      }),\r\n\r\n      $chats.insertOne({\r\n        players: [$playerSender.name, $playerReceiver.name],\r\n        messages: []\r\n      })\r\n    ]);\r\n\r\n    if (!$accountSender) {\r\n      return error(\"Account sender not found.\");\r\n    }\r\n\r\n    if (!$accountReceiver) {\r\n      return error(\"Account receiver not found.\");\r\n    }\r\n\r\n    if (!$chatInsert.insertedId) {\r\n      return error(\"Failed to insert chat.\");\r\n    }\r\n\r\n    socket.emit(\"acceptFriendSender\", {\r\n      name: $playerReceiver.name,\r\n      avatarId: $accountReceiver.avatarId,\r\n      status: $playerReceiver.status\r\n    });\r\n\r\n    server.io.to($playerReceiver.socketId).emit(\"acceptFriendReceiver\", {\r\n      name: $playerSender.name,\r\n      avatarId: $accountSender.avatarId,\r\n      status: $playerSender.status\r\n    });\r\n  });\r\n};\r\n\r\nexport {acceptFriend};\r\n","import {mongo, server} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst addFriend: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"addFriend\", async (params) => {\r\n    const {name} = params;\r\n\r\n    const [$playerSender, $playerReceiver] = await Promise.all([\r\n      $players.findOne({socketId}),\r\n      $players.findOne({name})\r\n    ]);\r\n\r\n    if (!$playerSender) {\r\n      return error(\"Player sender not found.\");\r\n    }\r\n\r\n    if (!$playerReceiver) {\r\n      return error(\"Player receiver not found.\");\r\n    }\r\n\r\n    const [$accountSender, $accountReceiver] = await Promise.all([\r\n      $accounts.findOne({name: $playerSender.name}),\r\n      $accounts.findOne({name: $playerReceiver.name})\r\n    ]);\r\n\r\n    if (!$accountSender) {\r\n      return error(\"Account sender not found.\");\r\n    }\r\n\r\n    if (!$accountReceiver) {\r\n      return error(\"Account receiver not found.\");\r\n    }\r\n\r\n    if ($accountSender.name === name) {\r\n      return error(\"You can't add yourself as a friend.\");\r\n    }\r\n\r\n    if ($accountReceiver.social.blocked.includes($accountSender.name)) {\r\n      return error(\"This player has blocked you.\");\r\n    }\r\n\r\n    if ($accountSender.social.blocked.includes(name)) {\r\n      return error(\"You have blocked this player.\");\r\n    }\r\n\r\n    if ($accountReceiver.social.requests.includes($accountSender.name)) {\r\n      return error(\"You have already sent the request to this player.\");\r\n    }\r\n\r\n    if ($accountSender.social.requests.includes(name)) {\r\n      return error(\"This player has already sent you the request.\");\r\n    }\r\n\r\n    if ($accountSender.social.friends.includes(name)) {\r\n      return error(\"This player is already your friend.\");\r\n    }\r\n\r\n    const $playerUpdate = await $accounts.updateOne({name}, {\r\n      $push: {\r\n        \"social.requests\": $accountSender.name\r\n      }\r\n    });\r\n\r\n    if (!$playerUpdate.modifiedCount) {\r\n      return error(\"Error updating player.\");\r\n    }\r\n\r\n    socket.emit(\"notification\", \"Friend request sent.\");\r\n\r\n    server.io.to($playerReceiver.socketId).emit(\"addFriend\", {\r\n      name: $accountSender.name\r\n    });\r\n  });\r\n};\r\n\r\nexport {addFriend};\r\n","import {mongo, server} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst blockFriend: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $chats, $players} = mongo;\r\n\r\n  socket.on(\"blockFriend\", async (params) => {\r\n    const {name} = params;\r\n\r\n    const [$playerSender, $playerReceiver] = await Promise.all([\r\n      $players.findOne({socketId}),\r\n      $players.findOne({name})\r\n    ]);\r\n\r\n    if (!$playerSender) {\r\n      return error(\"Player sender not found.\");\r\n    }\r\n\r\n    if (!$playerReceiver) {\r\n      return error(\"Player receiver not found.\");\r\n    }\r\n\r\n    const [\r\n      $accountSenderUpdate,\r\n      $accountReceiverUpdate,\r\n      $chatDelete\r\n    ] = await Promise.all([\r\n      $accounts.updateOne({\r\n        name: $playerSender.name\r\n      }, {\r\n        $pull: {\r\n          \"social.friends\": $playerReceiver.name\r\n        },\r\n        $push: {\r\n          \"social.blocked\": $playerReceiver.name\r\n        }\r\n      }),\r\n\r\n      $accounts.updateOne({\r\n        name: $playerReceiver.name\r\n      }, {\r\n        $pull: {\r\n          \"social.friends\": $playerSender.name\r\n        }\r\n      }),\r\n\r\n      $chats.deleteOne({\r\n        players: {\r\n          $all: [$playerReceiver.name, $playerSender.name]\r\n        }\r\n      })\r\n    ]);\r\n\r\n    if (!$accountSenderUpdate.modifiedCount) {\r\n      return error(\"Account sender not found.\");\r\n    }\r\n\r\n    if (!$accountReceiverUpdate.modifiedCount) {\r\n      return error(\"Account receiver not found.\");\r\n    }\r\n\r\n    if (!$chatDelete.deletedCount) {\r\n      return error(\"Failed to delete chat.\");\r\n    }\r\n\r\n    socket.emit(\"blockFriendSender\", {name});\r\n\r\n    server.io.to($playerReceiver.socketId).emit(\"blockFriendReceiver\", {\r\n      name: $playerSender.username\r\n    });\r\n  });\r\n};\r\n\r\nexport {blockFriend};\r\n","import {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst declineFriend: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"declineFriend\", async (params) => {\r\n    const {name} = params;\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const $accountUpdate = await $accounts.updateOne({\r\n      name: $player.name\r\n    }, {\r\n      $pull: {\r\n        \"social.requests\": name\r\n      }\r\n    });\r\n\r\n    if (!$accountUpdate.modifiedCount) {\r\n      return error(\"Failed to update account.\");\r\n    }\r\n\r\n    socket.emit(\"declineFriend\", {name});\r\n  });\r\n};\r\n\r\nexport {declineFriend};\r\n","import {mongo, server} from \"app\";\r\nimport type {UpdateFilter} from \"mongodb\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\nimport type {Account} from \"@som/shared/types/mongo\";\r\n\r\nconst removeFriend: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $chats, $players} = mongo;\r\n\r\n  socket.on(\"removeFriend\", async (params) => {\r\n    const {name} = params;\r\n\r\n    const [$playerSender, $playerReceiver] = await Promise.all([\r\n      $players.findOne({socketId}),\r\n      $players.findOne({name})\r\n    ]);\r\n\r\n    if (!$playerSender) {\r\n      return error(\"Player sender not found.\");\r\n    }\r\n\r\n    if (!$playerReceiver) {\r\n      return error(\"Player receiver not found.\");\r\n    }\r\n\r\n    const [\r\n      $accountSenderUpdate,\r\n      $accountReceiverUpdate,\r\n      $chatDelete\r\n    ] = await Promise.all([\r\n      $accounts.findOneAndUpdate({\r\n        name: $playerSender.name\r\n      }, {\r\n        $pull: {\r\n          \"social.friends\": name\r\n        } as UpdateFilter<Account> | Partial<Account>\r\n      }, {\r\n        returnDocument: \"after\"\r\n      }),\r\n\r\n      $accounts.findOneAndUpdate({name}, {\r\n        $pull: {\r\n          \"social.friends\": $playerSender.name\r\n        } as UpdateFilter<Account> | Partial<Account>\r\n      }, {\r\n        returnDocument: \"after\"\r\n      }),\r\n\r\n      $chats.deleteOne({\r\n        players: {\r\n          $all: [name, $playerSender.name]\r\n        }\r\n      })\r\n    ]);\r\n\r\n    if (!$accountSenderUpdate) {\r\n      return error(\"Account sender not found.\");\r\n    }\r\n\r\n    if (!$accountReceiverUpdate) {\r\n      return error(\"Account receiver not found.\");\r\n    }\r\n\r\n    if (!$chatDelete.deletedCount) {\r\n      return error(\"Failed to delete chat.\");\r\n    }\r\n\r\n    socket.emit(\"removeFriendSender\", {name});\r\n\r\n    server.io.to($playerReceiver.socketId).emit(\"removeFriendReceiver\", {\r\n      name: $accountSenderUpdate.name\r\n    });\r\n  });\r\n};\r\n\r\nexport {removeFriend};\r\n","import {mongo, server} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst sendChatMessage: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players, $chats} = mongo;\r\n  const {io} = server;\r\n\r\n  socket.on(\"sendChatMessage\", async (params) => {\r\n    const {receiver, text} = params;\r\n\r\n    const [$playerSender, $playerReceiver] = await Promise.all([\r\n      $players.findOne({socketId}),\r\n\r\n      $players.findOne({\r\n        name: receiver\r\n      })\r\n    ]);\r\n\r\n    if (!$playerSender) {\r\n      return error(\"Player sender not found, try relogging.\");\r\n    }\r\n\r\n    if (!$playerReceiver) {\r\n      return error(\"Player receiver not found, try relogging.\");\r\n    }\r\n\r\n    const $account = await $accounts.findOne({\r\n      name: $playerSender.name\r\n    });\r\n\r\n    if (!$account) {\r\n      return error(\"Account not found.\");\r\n    }\r\n\r\n    if (!$account.social.friends.includes(receiver)) {\r\n      return error(\"This user isn't your friend.\");\r\n    }\r\n\r\n    const date = new Date();\r\n\r\n    const $chatUpdate = await $chats.updateOne({\r\n      players: {\r\n        $all: [$playerSender.name, receiver]\r\n      }\r\n    }, {\r\n      $push: {\r\n        messages: {\r\n          name: $playerSender.name,\r\n          text,\r\n          date\r\n        }\r\n      } // pop first if length > 100!\r\n    });\r\n\r\n    if (!$chatUpdate.modifiedCount) {\r\n      return error(\"Error updating chat.\");\r\n    }\r\n\r\n    socket.emit(\"sendChatMessageSender\", {\r\n      sender: $playerSender.name,\r\n      receiver,\r\n      text,\r\n      date\r\n    });\r\n\r\n    io.to($playerReceiver.socketId).emit(\"sendChatMessageReceiver\", {\r\n      sender: $playerSender.name,\r\n      text,\r\n      date\r\n    });\r\n  });\r\n};\r\n\r\nexport {sendChatMessage};\r\n","import {mongo, server} from \"app\";\r\nimport {playerHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst setAvatar: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"setAvatar\", async (params) => {\r\n    const {avatarId} = params;\r\n\r\n    if (avatarId < 0 || avatarId > 4) {\r\n      return error(\"Invalid avatar.\");\r\n    }\r\n\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const $accountUpdate = await $accounts.findOneAndUpdate({\r\n      name: $player.name\r\n    }, {\r\n      $set: {avatarId}\r\n    }, {\r\n      returnDocument: \"after\"\r\n    });\r\n\r\n    if (!$accountUpdate) {\r\n      return error(\"Failed to update account.\");\r\n    }\r\n\r\n    const {name, social} = $accountUpdate;\r\n    const socketIds = await playerHelpers.getSocketIds(social.friends);\r\n\r\n    socket.emit(\"setAvatarSender\", {avatarId});\r\n    server.io.to(socketIds).emit(\"setAvatarReceiver\", {name, avatarId});\r\n  });\r\n};\r\n\r\nexport {setAvatar};\r\n","import {mongo} from \"app\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst unblockFriend: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"unblockFriend\", async (params) => {\r\n    const {name} = params;\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found, try relogging.\");\r\n    }\r\n\r\n    const $accountUpdate = await $accounts.updateOne({name: $player.name}, {\r\n      $pull: {\r\n        \"social.blocked\": name\r\n      }\r\n    });\r\n\r\n    if (!$accountUpdate.modifiedCount) {\r\n      return error(\"Failed to update account.\");\r\n    }\r\n\r\n    socket.emit(\"unblockFriend\", {name});\r\n  });\r\n};\r\n\r\nexport {unblockFriend};\r\n","import {mongo, server} from \"app\";\r\nimport {playerHelpers} from \"helpers\";\r\nimport type {SocketRequest} from \"@som/shared/types/backend\";\r\n\r\nconst updateStatus: SocketRequest = (socket, error): void => {\r\n  const socketId = socket.id;\r\n  const {$accounts, $players} = mongo;\r\n\r\n  socket.on(\"updateFriend\", async () => {\r\n    const $player = await $players.findOne({socketId});\r\n\r\n    if (!$player) {\r\n      return error(\"Player not found.\");\r\n    }\r\n\r\n    const $account = await $accounts.findOne({name: $player.name});\r\n\r\n    if (!$account) {\r\n      return error(\"Player account not found.\");\r\n    }\r\n\r\n    const {name, status} = $player;\r\n    const socketIds = await playerHelpers.getSocketIds($account.social.friends);\r\n\r\n    if (socketIds.length) {\r\n      server.io.to(socketIds).emit(\"updateFriend\", {name, status});\r\n    }\r\n  });\r\n};\r\n\r\nexport {updateStatus};\r\n","import {acceptFriend} from \"./acceptFriend\";\r\nimport {addFriend} from \"./addFriend\";\r\nimport {blockFriend} from \"./blockFriend\";\r\nimport {declineFriend} from \"./declineFriend\";\r\nimport {removeFriend} from \"./removeFriend\";\r\nimport {sendChatMessage} from \"./sendChatMessage\";\r\nimport {setAvatar} from \"./setAvatar\";\r\nimport {unblockFriend} from \"./unblockFriend\";\r\nimport {updateStatus} from \"./updateStatus\";\r\n\r\nconst sidenav = [\r\n  acceptFriend,\r\n  addFriend,\r\n  blockFriend,\r\n  declineFriend,\r\n  removeFriend,\r\n  sendChatMessage,\r\n  setAvatar,\r\n  unblockFriend,\r\n  updateStatus\r\n];\r\n\r\nexport {sidenav};\r\n","import {auth} from \"./auth\";\r\nimport {client} from \"./client\";\r\nimport {game} from \"./game\";\r\nimport {sidenav} from \"./sidenav\";\r\n\r\nconst requests = [...auth, ...client, ...game, ...sidenav];\r\n\r\nexport {requests};\r\n","import {mongo, server, contracts} from \"app\";\r\n// import {BigInt, utils} from \"ethers\";\r\nimport {requests} from \"requests\";\r\n\r\nprocess.on(\"unhandledRejection\", (reason, promise): void => {\r\n  console.log(`Unhandled rejection: ${reason}`);\r\n});\r\n\r\nprocess.on(\"uncaughtException\", (error, origin): void => {\r\n  console.log(`Uncaught Exception: ${error}`);\r\n});\r\n\r\n// maybe remove all rankedQueuePlayers, casualQueuePlayers, and gamePopups\r\n// when restarting the server?\r\n\r\n\r\n// put these ethereum events in separate files?\r\ncontracts.game.on(\"ListItem\", async (\r\n  seller: string,\r\n  listingId: bigint,\r\n  skinId: BigInt,\r\n  amount: BigInt,\r\n  price: BigInt\r\n): Promise<void> => {\r\n  const $account = await mongo.$accounts.findOne({\r\n    publicKey: seller.toLowerCase()\r\n  });\r\n\r\n  if (!$account) {\r\n    console.log(\"Item seller account not found, listing anyway...\");\r\n  }\r\n\r\n  await mongo.$marketItems.insertOne({\r\n    sellerName: $account ? $account.name : \"Not a player\",\r\n    sellerAddress: seller.toLowerCase(),\r\n    listingId: listingId.toString(),\r\n    skinId: skinId.toString(),\r\n    amount: amount.toString(),\r\n    price: price.toString()\r\n  });\r\n});\r\n\r\ncontracts.game.on(\"CancelItem\", async (listingId: BigInt): Promise<void> => {\r\n  const $marketItemDelete = await mongo.$marketItems.deleteOne({\r\n    listingId: listingId.toString()\r\n  });\r\n\r\n  if (!$marketItemDelete) {\r\n    console.log(`Error deleting item ${listingId} from market`);\r\n  }\r\n});\r\n\r\n// contracts.game.on(\"stake\", async () => {\r\n//   const accounts = await mongo.accounts.find().toArray();\r\n\r\n//   for (const account of accounts) {\r\n//     if (!account.publicKey) {\r\n//       return \"Metamask account not binded, can't receive rewards.\";\r\n//     }\r\n\r\n//     const total = await contracts.game.total();\r\n//     const playerChain = await contracts.game.players(account.publicKey);\r\n\r\n//     const rewardPerStaked = (total.rewards.pool * (10 ** 18)) / total.staked(1);\r\n//     const playerReward = (player.staked / (10 ** DECIMALS)) * rewardPerStaked;\r\n\r\n//     await contracts.game.distributeRewards(account.publicKey);\r\n//   }\r\n// });\r\n\r\ncontracts.game.on(\"BuyItem\", async (\r\n  listingId: BigInt,\r\n  amount: BigInt\r\n): Promise<void> => {\r\n  const $item = await mongo.$marketItems.findOne({\r\n    listingId: listingId.toString()\r\n  });\r\n\r\n  if (!$item) { return; }\r\n\r\n  // if (BigInt($item.amount) - amount < 0n) {\r\n  //   await mongo.marketItems.deleteOne({\r\n  //     listingId: listingId.toString()\r\n  //   });\r\n  // } else {\r\n  //   await mongo.marketItems.replaceOne({\r\n  //     listingId: listingId.toString()\r\n  //   }, {\r\n  //     ...$item,\r\n  //     amount: utils.formatUnits($item.amount.sub(amount), 0)\r\n  //   });\r\n  // }\r\n});\r\n\r\nserver.io.on(\"connection\", (socket): void => {\r\n  const error = (message: string): void => {\r\n    socket.emit(\"notification\", message);\r\n    console.error(message);\r\n  };\r\n\r\n  // put this in separate request file.\r\n  socket.on(\"getMarketItems\" as any, async () => {\r\n    const items = await mongo.$marketItems.find().limit(100).toArray();\r\n    socket.emit(\"getMarketItems\" as any, {items});\r\n  });\r\n\r\n  requests.forEach((request): void => {\r\n    request(socket, error);\r\n  });\r\n});\r\n\r\nserver.http.listen(process.env.PORT || 4201);\r\n"],"names":["game"],"mappings":"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"}